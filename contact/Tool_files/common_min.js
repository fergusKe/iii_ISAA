// COMPILED SCRIPTS

// Original file: conditionizr.min.js
var conditionizr=function(e){function t(e,n){for(var r in n)try{e[r]=n[r].constructor==Object?t(e[r],n[r]):n[r]}catch(i){e[r]=n[r]}return e}function n(){for(var e in c){var t=c[e],n=i.getElementsByTagName("head")[0];if("classes"===e&&t&&(s.className+=" "+h),"scripts"===e&&t){var r=i.createElement("script");r.src=o.scriptSrc+h+".js",n.appendChild(r)}if("styles"===e&&t){var u=i.createElement("link");u.rel="stylesheet",u.href=o.styleSrc+h+".css",n.appendChild(u)}if("customScript"===e&&t)for(var a=c.customScript.replace(/\s/g,""),f=a.split(","),l=0;f.length>l;l++){var p=i.createElement("script");p.src=f[l],n.appendChild(p)}}}function r(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,n=RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return e}var i=document,s=i.documentElement;s.id="conditionizr";var o={debug:!1,scriptSrc:"js/conditionizr/",styleSrc:"css/conditionizr/",ieLessThan:{active:!1,version:"9",scripts:!1,styles:!1,classes:!0,customScript:!1},chrome:{scripts:!1,styles:!1,classes:!0,customScript:!1},safari:{scripts:!1,styles:!1,classes:!0,customScript:!1},opera:{scripts:!1,styles:!1,classes:!0,customScript:!1},firefox:{scripts:!1,styles:!1,classes:!0,customScript:!1},ie10:{scripts:!1,styles:!1,classes:!0,customScript:!1},ie9:{scripts:!1,styles:!1,classes:!0,customScript:!1},ie8:{scripts:!1,styles:!1,classes:!0,customScript:!1},ie7:{scripts:!1,styles:!1,classes:!0,customScript:!1},ie6:{scripts:!1,styles:!1,classes:!0,customScript:!1},retina:{scripts:!1,styles:!1,classes:!0,customScript:!1},touch:{scripts:!1,styles:!1,classes:!0,customScript:!1},mac:!0,win:!0,x11:!0,linux:!0};e&&t(o,e);for(var u="",a=[{testWith:"chrome",testSettings:o.chrome},{testWith:"safari",testSettings:o.safari},{testWith:"firefox",testSettings:o.firefox},{testWith:"opera",testSettings:o.opera}],f=0;a.length>f;f++){var l=a[f];if(navigator.userAgent.toLowerCase().indexOf(l.testWith)>-1){var c=l.testSettings,h=l.testWith;n(),u=h;break}}var p=r();if(p>-1){if(o.ieLessThan.version+".0">p){var h="lt-ie"+o.ieLessThan.version,c=o.ieLessThan;n()}if(10===p)var c=o.ie10;else if(9===p)var c=o.ie9;else if(8===p)var c=o.ie8;else if(7===p)var c=o.ie7;else if(6===p)var c=o.ie6;var h="ie"+p;n(),u=h}var d="";if(window.devicePixelRatio>=2){var c=o.retina,h="retina";n(),d+=" "+h,h=u}else s.className+=" no-retina";if("ontouchstart"in window){var c=o.touch,h="touch";n(),d+=" "+h,h=u}else s.className+=" no-touch";for(var v=[{testWith:"Win",testSettings:o.win},{testWith:"Mac",testSettings:o.mac},{testWith:"X11",testSettings:o.x11},{testWith:"Linux",testSettings:o.linux}],f=0;v.length>f;f++){var m=v[f];if(navigator.appVersion.indexOf(m.testWith)>-1){var g=m.testSettings,y=m.testWith;g&&(s.className+=" "+m.testWith.toLowerCase());break}}o.debug&&(console.log("Start Conditionizr Debug\n"),console.log("Script location: "+o.scriptSrc),console.log("Style location: "+o.styleSrc),console.log("Browser: "+h),d&&console.log("Browser Extras: "+d),console.log("OS: "+y),console.log("End Conditionizr Debug\n"))};
// Original file: squareroot-min.js
window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var SQR=function(){return typeof window.Float32Array=="undefined"&&(window.Float32Array=window.Array),{DYNAMIC_TRANSFORM:0,STATIC_TRANSFORM:1,twoPI:Math.PI*2,deg2rad:Math.PI/180,rad2deg:180/Math.PI,supportsCss3d:!1,usePreserve3d:!1}}();SQR.BUILD=49,SQR.Squareroot=function(e,t){this.setBackground=function(t){e&&(e.style.backgroundColor=t)},this.setClearColor=function(e){s=e},this.setProjection=function(e){i.cssDistance=.5/Math.tan(e*Math.PI/360)*i.height,i.projection.perspective(e,i.width/i.height,.1,1e3),t&&(t.style.perspective=i.cssDistance+"px",t.style["-webkit-perspective"]=i.cssDistance+"px",t.style["-moz-perspective"]=i.cssDistance+"px",t.style["-o-perspective"]=i.cssDistance+"px")},this.cssDistance=function(){return i.cssDistance},this.setSize=function(t,n){i.width=t,i.height=n,e&&(e.width=t,e.height=n),i.aspect=t/n,i.centerX=t*.5,i.centerY=n*.5},this.children=[],this.numChildren=0;var n=[];this.add=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];t.parent=null,this.children.indexOf(t)==-1&&this.children.push(t)}this.numChildren=this.children.length},this.remove=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e],n=this.children.indexOf(t);if(n==-1)return!1;t.parent=null,t.renderer&&(t.renderer.isDom2d||t.renderer.isDom3d)&&t.renderer.removeFromDom(),this.children.splice(n,1)}this.numChildren=this.children.length},this.contains=function(e){return this.children.indexOf(e)>-1},this.recurse=function(e){for(var t=0;t<this.numChildren;t++)this.children[t].recurse(e)},this.removeAll=function(){for(var e=0;e<this.numChildren;e++){var t=this.children[e];t.parent=null,t.renderer&&(t.renderer.isDom2d||t.renderer.isDom3d)&&t.renderer.removeFromDom()}this.children=[],this.numChildren=this.children.length};var r=function(e){e.renderer&&(e.renderer.isDom3d&&SQR.usePreserve3d&&e.parent&&e.parent.renderer&&e.parent.renderer.isDom3d?e.renderer.appendToDom(e.parent.renderer.element):(e.renderer.isDom2d||e.renderer.isDom3d)&&e.renderer.appendToDom(t)),e.transformWorld(),n.push(e);if(e.numChildren>0)for(var i=0;i<e.numChildren;i++)r(e.children[i])};this.render=function(t){SQR.Time.tick(),n.length=0,i.context&&(i.context.setTransform(1,0,0,1,0,0),s!=null?(i.context.fillStyle=s,i.context.fillRect(0,0,e.width,e.height)):i.context.clearRect(0,0,e.width,e.height));for(var o=0;o<this.numChildren;o++)r(this.children[o]);var u=n.length;i.camera=t,i.viewMatrix=t.computeInverseMatrix(),i.lightDirection=this.lightDirection;for(o=0;o<u;o++)t=n[o],t.transformView(i.viewMatrix);n.sort(function(e,t){var n=e.depth(),r=t.depth();return n<r?-1:n>r?1:0});for(o=0;o<u;o++)if(t=n[o],t.enabled)t.renderer&&(i.depth=o,t.renderer.draw(t,i)),t.collider&&t.collider.project(t,i)};var i={};e&&(i.context=e.getContext("2d"),this.setSize(e.width,e.height)),i.projection=new SQR.ProjectionMatrix,i.container=t,this.lightDirection=(new SQR.V3(0,1,0)).norm();var s=null},SQR.Transform=function(e){this.name=e,this.enabled=!0,this.useQuaternion=this.directMatrixMode=!1,this.engine=this.parent=this.collider=this.geometry=this.renderer=null,this.position=new SQR.V3,this.rotation=new SQR.V3,this.rotationQ=new SQR.Quaternion,this.scale=new SQR.V3(1,1,1);var t=new SQR.V3;this.matrix=new SQR.Matrix44,this.globalMatrix=new SQR.Matrix44,this.viewMatrix=new SQR.Matrix44,this.inverseWorldMatrix=new SQR.Matrix44,this.positioningMode=0,this.depth=function(){return this.viewMatrix.data[14]},this.children=[],this.numChildren=0,this.add=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];t.parent=this,this.children.indexOf(t)==-1&&this.children.push(t)}this.numChildren=this.children.length},this.remove=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e],n=this.children.indexOf(t);if(n==-1)return!1;t.parent=null,t.renderer&&(t.renderer.isDom2d||t.renderer.isDom3d)&&t.renderer.removeFromDom(),this.children.splice(n,1)}this.numChildren=this.children.length},this.contains=function(e){return this.children.indexOf(e)>-1},this.recurse=function(e){e(this);for(var t=0;t<this.numChildren;t++)this.children[t].recurse(e)},this.removeAll=function(){for(var e=0;e<this.numChildren;e++){var t=this.children[e];t.parent=null,t.renderer&&(t.renderer.isDom2d||t.renderer.isDom3d)&&t.renderer.removeFromDom()}this.children=[],this.numChildren=this.children.length},this.transformWorld=function(){if(this.positioningMode!=2){if(!this.directMatrixMode){var e=this.position,t=this.rotationQ,n=this.rotation,r=this.scale;this.useQuaternion?this.matrix.setTQS(e.x,e.y,e.z,t.w,t.x,t.y,t.z,r.x,r.y,r.z):this.matrix.setTRS(e.x,e.y,e.z,n.x,n.y,n.z,r.x,r.y,r.z)}this.lookDirection&&this.matrix.lookAt(this.lookDirection,SQR.V3.up),this.parent?(this.parent.globalMatrix.copyTo(this.globalMatrix),this.globalMatrix.multiply(this.matrix)):this.matrix.copyTo(this.globalMatrix),this.lookTarget&&this.globalMatrix.lookAt(this.lookTarget.globalPosition(),SQR.V3.up),this.positioningMode==1&&(this.positioningMode=2)}},this.globalPosition=function(){return this.globalMatrix.extractPosition(t),t},this.transformView=function(e){e.copyTo(this.viewMatrix),this.viewMatrix.multiply(this.globalMatrix)},this.lookAt=function(e){this.lookTarget=e},this.lookInDirection=function(e){this.lookDirection=e},this.computeInverseMatrix=function(){return this.globalMatrix.inverse(this.inverseWorldMatrix),this.inverseWorldMatrix}},SQR.Geometry=function(){this.tangents=this.normals=this.particleTextures=this.colors=this.polygons=this.vertices=null,this.closed=this.continous=!1,this.color=null},SQR.Geometry.prototype.addTriangle=function(e,t,n,r){this.polygons||(this.polygons=[]),this.polygons.push(new SQR.Triangle(e,t,n,r))},SQR.Geometry.prototype.addQuad=function(e,t,n,r,i){this.polygons||(this.polygons=[]),this.polygons.push(new SQR.Quad(e,t,n,r,i))},SQR.Geometry.prototype.addSegment=function(e,t,n){this.vertices||(this.vertices=[]),this.vertices.push(e,t),n&&(this.colors||(this.colors=[]),this.colors.push(n))},SQR.Plane=function(e,t,n,r,i,s,o){this.polygons=[],n=n||1,r=r||1,e*=.5,t*=.5,i=-e+(i||0),s=-t+(s||0);var u=e*2/n,a=t*2/r,f,l;for(f=0;f<n;f++)for(l=0;l<r;l++){var c=i+f*u,h=c+u,p=s+l*a,d=p+a,v;o?(v=new SQR.V3(c,0,p),p=new SQR.V3(h,0,p),h=new SQR.V3(h,0,d),c=new SQR.V3(c,0,d)):(v=new SQR.V3(c,p,0),p=new SQR.V3(h,p,0),h=new SQR.V3(h,d,0),c=new SQR.V3(c,d,0)),d=new SQR.Color(0,100,70),this.polygons.push(new SQR.Triangle(v,p,h,d)),this.polygons.push(new SQR.Triangle(v,h,c,d))}this.applyHeightMap=function(n,r,i,s){for(var o=this.polygons.length,u=function(o){var u=(o.z/t+1)/2,a=(o.x/e+1)/2;u=(i+u*s)%1,u=SQR.CanvasUtil.getPixelNormRed(n,a,u)/255*r,o.y=r-u},a=0;a<o;a++){var f=this.polygons[a];u(f.a),u(f.b),u(f.c)}}},SQR.Quad=function(e,t,n,r,i){var s=this;this.a=e,this.b=t,this.c=n,this.d=r,this.color=i,this.sa=new SQR.V3,this.sb=new SQR.V3,this.sc=new SQR.V3,this.sd=new SQR.V3,this.normal=new SQR.V3,this.center=new SQR.V3,this.depth=0,this.update=function(e,t,n){this.a.copyTo(this.sa),this.b.copyTo(this.sb),this.c.copyTo(this.sc),this.d.copyTo(this.sd),e.transformVector(this.sa),e.transformVector(this.sb),e.transformVector(this.sc),e.transformVector(this.sd),this.center.set(0,0,0).add(this.sa,this.sb).add(this.center,this.sc).mul(1/3),this.depth=this.center.z,this.sa.x=this.sa.x/this.sa.z*t+t,this.sa.y=this.sa.y/this.sa.z*n+n,this.sb.x=this.sb.x/this.sb.z*t+t,this.sb.y=this.sb.y/this.sb.z*n+n,this.sc.x=this.sc.x/this.sc.z*t+t,this.sc.y=this.sc.y/this.sc.z*n+n,this.sd.x=this.sd.x/this.sd.z*t+t,this.sd.y=this.sd.y/this.sd.z*n+n,e=SQR.VectorUtil.__tv1,t=SQR.VectorUtil.__tv2,n=SQR.VectorUtil.__tv3,e.sub(s.sa,s.sb),t.sub(s.sc,s.sb),n.sub(s.sc,s.sd),e.cross(e,t),n.cross(t,n),s.normal.add(e,n).norm()}},SQR.Triangle=function(e,t,n,r){var i=this;this.a=e,this.b=t,this.c=n,this.color=r,this.sa=new SQR.V3,this.sb=new SQR.V3,this.sc=new SQR.V3,this.normal=new SQR.V3,this.center=new SQR.V3,this.depth=0,this.update=function(e,t,n){this.a.copyTo(this.sa),this.b.copyTo(this.sb),this.c.copyTo(this.sc),e.transformVector(this.sa),e.transformVector(this.sb),e.transformVector(this.sc),this.center.set(0,0,0).add(this.sa,this.sb).add(this.center,this.sc).mul(1/3),this.depth=this.center.z,this.sa.x=this.sa.x/this.sa.z*t+t,this.sa.y=this.sa.y/this.sa.z*n+n,this.sb.x=this.sb.x/this.sb.z*t+t,this.sb.y=this.sb.y/this.sb.z*n+n,this.sc.x=this.sc.x/this.sc.z*t+t,this.sc.y=this.sc.y/this.sc.z*n+n,e=SQR.VectorUtil.__tv1,t=SQR.VectorUtil.__tv2,e.sub(i.sa,i.sb),t.sub(i.sa,i.sc),i.normal.cross(e,t).norm()}},SQR.Interpolation={bezierPosition:function(e,t,n,r,i){return t*(1-e)*(1-e)*(1-e)+n*3*e*(1-e)*(1-e)+r*3*e*e*(1-e)+i*e*e*e},bezierVelocity:function(e,t,n,r,i){return 3*n-3*t+2*(3*t-6*n+3*r)*e+3*(-t+3*n-3*r+i)*e*e},linear:function(e,t,n){return n<=e?e:n>=t?t:e+(t-e)*((n-e)/(t-e))},smoothStep:function(e,t,n){return n<=e?e:n>=t?t:(n=(n-e)/(t-e),e+(t-e)*(3*n*n-2*n*n*n))},quadIn:function(e){return e*e},quadOut:function(e){return e*(2-e)},quadInOut:function(e){return(e*=2)<1?.5*e*e:-0.5*(--e*(e-2)-1)}},SQR.Mathx={clamp:function(e,t,n){return e<t?t:e>n?n:e},clamp01:function(e){return e<0?0:e>1?1:e},step:function(e,t){return t>=e?1:0}},SQR.Matrix2D=function(){typeof Float32Array=="undefined"&&(Float32Array=Array),this.data=new Float32Array(9);var e,t,n,r,i;this.identity=function(e){return e=e||this.data,e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,this},this.transformVector=function(e){return n=this.data,r=e.x,i=e.y,e.x=n[0]*r+n[1]*i+n[2],e.y=n[3]*r+n[4]*i+n[5],e},this.setTranslation=function(e,t,r){return n=r||this.data,n[0]=1,n[1]=0,n[2]=e,n[3]=0,n[4]=1,n[5]=t,n[6]=0,n[7]=0,n[8]=1,this},this.getTranslation=function(e){return n=this.data,e=e||new SQR.V2,e.x=n[2],e.y=n[5],e},this.setScale=function(e,t,r){return n=r||this.data,n[0]=e,n[1]=0,n[2]=0,n[3]=0,n[4]=t,n[5]=0,n[6]=0,n[7]=0,n[8]=1,this},this.setShear=function(e,t,r){return n=r||this.data,n[0]=1,n[1]=e,n[2]=0,n[3]=t,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,this},this.setRotation=function(e,t){n=t||this.data;var r=Math.cos(e),i=Math.sin(e);return n[0]=r,n[1]=-i,n[2]=0,n[3]=i,n[4]=r,n[5]=0,n[6]=0,n[7]=0,n[8]=1,this},this.setTRS=function(e,t,r,i,s){n=this.data;var o=Math.cos(r);return r=Math.sin(r),n[0]=o*i,n[1]=-r*s,n[2]=e,n[3]=r*i,n[4]=o*s,n[5]=t,n[6]=0,n[7]=0,n[8]=1,this},this.translate=function(e,t){return this.identity(SQR.Matrix2D.__temp),this.setTranslation(e,t,SQR.Matrix2D.__temp),this.multiply(SQR.Matrix2D.__temp)},this.rotate=function(e){return this.identity(SQR.Matrix2D.__temp),this.setRotation(e,SQR.Matrix2D.__temp),this.multiply(SQR.Matrix2D.__temp)},this.scale=function(e,t){return this.identity(SQR.Matrix2D.__temp),this.setScale(e,t,SQR.Matrix2D.__temp),this.multiply(SQR.Matrix2D.__temp)},this.shear=function(e,t){return this.identity(SQR.Matrix2D.__temp),this.setRotation(e,t,SQR.Matrix2D.__temp),this.multiply(SQR.Matrix2D.__temp)};var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;this.multiply=function(n){return e=this.data,t=n.data||n,s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=t[0],h=t[1],p=t[2],d=t[3],v=t[4],m=t[5],g=t[6],y=t[7],b=t[8],e[0]=s*c+o*d+u*g,e[1]=s*h+o*v+u*y,e[2]=s*p+o*m+u*b,e[3]=a*c+f*d+l*g,e[4]=a*h+f*v+l*y,e[5]=a*p+f*m+l*b,this},this.copyTo=function(n){return e=this.data,t=n.data||n,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],n},this.copyFrom=function(n){return e=n.data||n,t=this.data,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this};var w=function(e){return Math.abs(e)<1e-6?0:e};this.getAsCSSProperty=function(e){var t=this.data;return e?"matrix3d("+w(t[0])+","+w(t[3])+",0,0,"+w(t[1])+","+w(t[4])+",0,0,0,0,1,0,"+w(t[2])+","+w(t[5])+",0,1)":"matrix("+w(t[0])+","+w(t[3])+","+w(t[1])+","+w(t[4])+","+w(t[2])+","+w(t[5])+")"},this.identity()},SQR.Matrix33=function(){this.data=new Float32Array(9),this.identity=function(){var e=this.data;return e[0]=1,e[3]=0,e[6]=0,e[1]=0,e[4]=1,e[7]=0,e[2]=0,e[5]=0,e[8]=1,this},this.transformVector=function(e,t){var n=this.data,r=e.x,i=e.y,s=e.z;return t=t||e,t.x=n[0]*r+n[3]*i+n[6]*s,t.y=n[1]*r+n[4]*i+n[7]*s,t.z=n[2]*r+n[5]*i+n[8]*s,t},this.determinant=function(){var e=this.data;return e[0]*(e[4]*e[8]-e[7]*e[5])+e[3]*(e[7]*e[2]-e[1]*e[8])+e[6]*(e[1]*e[5]-e[4]*e[2])},this.inverse=function(e){var t=this.data;e=e||this.data;var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=l*o-u*f,h=-l*s+u*a,p=f*s-o*a;return t=n*c+r*h+i*p,t?(t=1/t,e[0]=c*t,e[1]=(-l*r+i*f)*t,e[2]=(u*r-i*o)*t,e[3]=h*t,e[4]=(l*n-i*a)*t,e[5]=(-u*n+i*s)*t,e[6]=p*t,e[7]=(-f*n+r*a)*t,e[8]=(o*n-r*s)*t,e):(console.warn("Attempt to inverse a singular matrix44. ",this.data),e)},this.transpose=function(){var e=this.data,t=e[3],n=e[6],r=e[1],i=e[4],s=e[7],o=e[2],u=e[5],a=e[8];e[0]=e[0],e[1]=t,e[2]=n,e[3]=r,e[4]=i,e[5]=s,e[6]=o,e[7]=u,e[8]=a}},SQR.Matrix44=function(){this.data=new Float32Array(16),this.identity=function(e){e=e||this.data,e[0]=1,e[4]=0,e[8]=0,e[12]=0,e[1]=0,e[5]=1,e[9]=0,e[13]=0,e[2]=0,e[6]=0,e[10]=1,e[14]=0,e[3]=0,e[7]=0,e[11]=0,e[15]=1},this.transformVector=function(e,t){var n=this.data,r=e.x,i=e.y,s=e.z,o=e.w;return t=t||e,t.x=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t.y=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t.z=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t},this.multiply=function(e){var t=this.data,n=e.data||e,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=n[0],b=n[1],w=n[2],E=n[3],S=n[4],x=n[5],T=n[6],N=n[7],C=n[8],k=n[9],L=n[10],A=n[11],O=n[12],M=n[13],_=n[14],n=n[15],t[0]=e*y+o*b+l*w+d*E,t[1]=r*y+u*b+c*w+v*E,t[2]=i*y+a*b+h*w+m*E,t[3]=s*y+f*b+p*w+g*E,t[4]=e*S+o*x+l*T+d*N,t[5]=r*S+u*x+c*T+v*N,t[6]=i*S+a*x+h*T+m*N,t[7]=s*S+f*x+p*T+g*N,t[8]=e*C+o*k+l*L+d*A,t[9]=r*C+u*k+c*L+v*A,t[10]=i*C+a*k+h*L+m*A,t[11]=s*C+f*k+p*L+g*A,t[12]=e*O+o*M+l*_+d*n,t[13]=r*O+u*M+c*_+v*n,t[14]=i*O+a*M+h*_+m*n,t[15]=s*O+f*M+p*_+g*n,this},this.setTQS=function(e,t,n,r,i,s,o,u,a,f,l){var c=l||this.data;this.identity(l);var h=i*i,p=s*s,d=o*o;return c[0]=(1-2*p-2*d)*u,c[1]=(2*i*s-2*o*r)*u,c[2]=(2*i*o+2*s*r)*u,c[4]=(2*i*s+2*o*r)*a,c[5]=(1-2*h-2*d)*a,c[6]=(2*s*o-2*i*r)*a,c[8]=(2*i*o-2*s*r)*f,c[9]=(2*s*o+2*i*r)*f,c[10]=(1-2*h-2*p)*f,c[12]=e,c[13]=t,c[14]=n,l||this},this.setTRS=function(e,t,n,r,i,s,o,u,a,f){var l=f||this.data;this.identity(f);var c=Math.sin(r);r=Math.cos(r);var h=Math.sin(i);i=Math.cos(i);var p=Math.sin(s);return s=Math.cos(s),l[0]=(i*s+h*c*p)*o,l[1]=(-i*p+h*c*s)*o,l[2]=h*r*o,l[4]=p*r*u,l[5]=s*r*u,l[6]=-c*u,l[8]=(-h*s+i*c*p)*a,l[9]=(p*h+i*c*s)*a,l[10]=i*r*a,l[12]=e,l[13]=t,l[14]=n,f||this},this.setScale=function(e,t,n,r){var i=r||this.data;return this.identity(r),i[0]=e,i[5]=t,i[10]=n,r||this},this.setTranslation=function(e,t,n,r){var i=r||this.data;return this.identity(r),i[12]=e,i[13]=t,i[14]=n,r||this},this.setRotation=function(e,t,n,r){var i=r||this.data;this.identity(r);var s=Math.sin(e);e=Math.cos(e);var o=Math.sin(t);t=Math.cos(t);var u=Math.sin(n);return n=Math.cos(n),i[0]=t*n+o*s*u,i[1]=-t*u+o*s*n,i[2]=o*e,i[4]=u*e,i[5]=n*e,i[6]=-s,i[8]=-o*n+t*s*u,i[9]=u*o+t*s*n,i[10]=t*e,r||this},this.translate=function(e,t,n){return this.setTranslation(e,t,n,SQR.Matrix44.__temp),this.multiply(SQR.Matrix44.__temp)},this.rotate=function(e,t,n){return this.setRotation(e,t,n,SQR.Matrix44.__temp),this.multiply(SQR.Matrix44.__temp)},this.scale=function(e,t,n){return this.setScale(e,t,n,SQR.Matrix44.__temp),this.multiply(SQR.Matrix44.__temp)},this.copyTo=function(e){for(var t=this.data,n=e.data||e,r=0;r<16;r++)n[r]=t[r];return e},this.copyRotationTo=function(e){var t=this.data,n=e.data||e;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],e};var e=function(e){return Math.abs(e)<1e-6?0:e};this.getAsCSSProperty=function(){var t=this.data;return"matrix3d("+e(t[0])+","+e(t[1])+","+e(t[2])+","+e(t[3])+","+e(t[4])+","+e(t[5])+","+e(t[6])+","+e(t[7])+","+e(t[8])+","+e(t[9])+","+e(t[10])+","+e(t[11])+","+e(t[12])+","+e(t[13])+","+e(t[14])+","+e(t[15])+")"},this.extractPosition=function(e){var t=this.data;return e.set(t[12],t[13],t[14]),e},this.determinant=function(){var e=this.data;return e[0]*(e[5]*e[10]-e[9]*e[6])+e[4]*(e[9]*e[2]-e[1]*e[10])+e[8]*(e[1]*e[6]-e[5]*e[2])},this.inverse=function(e){var t=this.data,n=e?e.data||e:this.data,r=this.determinant();if(Math.abs(r)<1e-4)return console.warn("Attempt to inverse a singular matrix44. ",this.data),console.trace(),e;var i=t[0],s=t[4],o=t[8],u=t[12],a=t[1],f=t[5],l=t[9],c=t[13],h=t[2],p=t[6],d=t[10];return t=t[14],r=1/r,n[0]=(f*d-l*p)*r,n[1]=(o*p-s*d)*r,n[2]=(s*l-o*f)*r,n[4]=(l*h-a*d)*r,n[5]=(i*d-o*h)*r,n[6]=(o*a-i*l)*r,n[8]=(a*p-f*h)*r,n[9]=(s*h-i*p)*r,n[10]=(i*f-s*a)*r,n[12]=-(u*n[0]+c*n[4]+t*n[8]),n[13]=-(u*n[1]+c*n[5]+t*n[9]),n[14]=-(u*n[2]+c*n[6]+t*n[10]),e},this.transpose=function(e){var t=this.data;e=e?e.data||e:this.data;var n=t[4],r=t[8],i=t[1],s=t[5],o=t[9],u=t[2],a=t[6],f=t[10];e[0]=t[0],e[1]=n,e[2]=r,e[4]=i,e[5]=s,e[6]=o,e[8]=u,e[9]=a,e[10]=f},this.lookAt=function(e,t){var n=this.data,r=SQR.Matrix44.__tv1,i=SQR.Matrix44.__tv2,s=SQR.Matrix44.__tv3;return s.set(n[12],n[13],n[14]),s.sub(s,e).norm(),s.magsq()===0&&(s.z=1),r.cross(t,s).norm(),r.magsq()===0&&(s.x+=1e-4,r.cross(t,s).norm()),i.cross(s,r),n[0]=r.x,n[4]=i.x,n[8]=s.x,n[1]=r.y,n[5]=i.y,n[9]=s.y,n[2]=r.z,n[6]=i.z,n[10]=s.z,this},this.identity()},SQR.Noise={random3_seed:1},SQR.Noise.isPrime=function(e){for(var t=2;t<=e-1;t++)if(e%t==0)return!1;return!0},SQR.Noise.random1=function(e){return e^=e<<13,1-(e*(e*e*15731+789221)+1376312589&2147483647)/1073741824},SQR.Noise.random2=function(e){return e^=e<<13,(e*16807+16807)%255},SQR.Noise.random3=function(){return SQR.Noise.random3_seed=SQR.Noise.random3_seed*16807%2147483647,SQR.Noise.random3_seed/2147483647};var ImprovedNoise=function(){function e(e){return e*e*e*(e*(e*6-15)+10)}function t(e,t,n){return t+e*(n-t)}function n(e,t,n,r){e&=15;var i=e<8?t:n;return t=e<4?n:e==12||e==14?t:r,((e&1)==0?i:-i)+((e&2)==0?t:-t)}for(var r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],i=0;i<256;i++)r[256+i]=r[i];return{noise:function(i,s,o){var u=~~i,f=~~s,l=~~o,h=u&255,p=f&255,v=l&255;i-=u,s-=f,o-=l,u=i-1,f=s-1,l=o-1;var m=e(i),g=e(s),y=e(o),w=r[h]+p,E=r[w]+v;return w=r[w+1]+v,p=r[h+1]+p,h=r[p]+v,v=r[p+1]+v,t(y,t(g,t(m,n(r[E],i,s,o),n(r[h],u,s,o)),t(m,n(r[w],i,f,o),n(r[v],u,f,o))),t(g,t(m,n(r[E+1],i,s,l),n(r[h+1],u,s,o-1)),t(m,n(r[w+1],i,f,l),n(r[v+1],u,f,l))))}}};SQR.ProjectionMatrix=function(){typeof Float32Array=="undefined"&&(Float32Array=Array),this.data=new Float32Array(16),this.copyTo=function(e){for(var t=this.data,n=e.data||e,r=0;r<16;r++)n[r]=t[r];return e},this.identity()},SQR.ProjectionMatrix.prototype.identity=function(){var e=this.data;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},SQR.ProjectionMatrix.prototype.perspective=function(e,t,n,r){var i=this.data;e=n*Math.tan(e*Math.PI/360);var s=r-n;i[0]=n/(e*t),i[4]=0,i[8]=0,i[12]=0,i[1]=0,i[5]=n/e,i[9]=0,i[13]=0,i[2]=0,i[6]=0,i[10]=-(r+n)/s,i[14]=-(2*r*n)/s,i[3]=0,i[7]=0,i[11]=-1,i[15]=0},SQR.ProjectionMatrix.prototype.transformVector=function(e,t){var n=e.x,r=e.y,i=e.z,s=e.w,o=this.data;return t=t||e,t.x=o[0]*n+o[4]*r+o[8]*i+o[12]*s,t.y=o[1]*n+o[5]*r+o[9]*i+o[13]*s,t.z=o[2]*n+o[6]*r+o[10]*i+o[14]*s,t},SQR.ProjectionMatrix.prototype.inverse=function(e){var t=this.data;e=e||this.data;var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14];t=t[15];var g=n*u-r*o,y=n*a-i*o,b=n*f-s*o,w=r*a-i*u,E=r*f-s*u,S=i*f-s*a,x=l*v-c*d,T=l*m-h*d,N=l*t-p*d,C=c*m-h*v,k=c*t-p*v,L=h*t-p*m,A=g*L-y*k+b*C+w*N-E*T+S*x;return A?(A=1/A,e[0]=(u*L-a*k+f*C)*A,e[1]=(-r*L+i*k-s*C)*A,e[2]=(v*S-m*E+t*w)*A,e[3]=(-c*S+h*E-p*w)*A,e[4]=(-o*L+a*N-f*T)*A,e[5]=(n*L-i*N+s*T)*A,e[6]=(-d*S+m*b-t*y)*A,e[7]=(l*S-h*b+p*y)*A,e[8]=(o*k-u*N+f*x)*A,e[9]=(-n*k+r*N-s*x)*A,e[10]=(d*E-v*b+t*g)*A,e[11]=(-l*E+c*b-p*g)*A,e[12]=(-o*C+u*T-a*x)*A,e[13]=(n*C-r*T+i*x)*A,e[14]=(-d*w+v*y-m*g)*A,e[15]=(l*w-c*y+h*g)*A,e):null},SQR.QuadraticBezier=function(e,t,n,r){if(!e||!t&&!n||!r)throw"Failed to create cruve: 4 2D|3D vectors are required.";this.p0=e,this.c0=t,this.c1=n,this.p1=r;var i=e.clone().set(),s=SQR.Interpolation.bezierPosition,o=SQR.Interpolation.bezierVelocity;this.velocityAt=function(e,t){return t=t||i,t.x=o(e,this.p0.x,this.c0.x,this.c1.x,this.p1.x),t.y=o(e,this.p0.y,this.c0.y,this.c1.y,this.p1.y),t.z&&this.p0.z&&(t.z=o(e,this.p0.z,this.c0.z,this.c1.z,this.p1.z)),t},this.valueAt=function(e,t){return t=t||i,t.x=s(e,this.p0.x,this.c0.x,this.c1.x,this.p1.x),t.y=s(e,this.p0.y,this.c0.y,this.c1.y,this.p1.y),t.z!=null&&this.p0.z!=null&&(t.z=s(e,this.p0.z,this.c0.z,this.c1.z,this.p1.z)),t},this.createSegment=function(e,t){var n=t||new SQR.Geometry;n.continous=!0,n.vertices=n.vertices||[],n.tangents=n.tangents||[];for(var r=0;r<=e;r++){var i=r/e;n.vertices.push(this.valueAt(i,new SQR.V3)),n.tangents.push(this.velocityAt(i,new SQR.V3))}return n},this.createRibbon=function(e,t,n,r){r=r||new SQR.Geometry;for(var i=0;i<e;i++){var s=i/e,o=(i+1)/e,u=this.valueAt(s,new SQR.V3),a=this.valueAt(o,new SQR.V3);s=this.velocityAt(s,new SQR.V3).norm();var f=this.velocityAt(o,new SQR.V3).norm(),l=new SQR.V3;l.cross(s,f).norm(),o=new SQR.V3,o.cross(s,l),s=new SQR.V3,s.cross(f,l),o.mul(t*.5),s.mul(t*.5),f=new SQR.V3,l=new SQR.V3;var c=new SQR.V3,h=new SQR.V3;f.add(u,o),l.add(u,o.neg()),c.add(a,s),h.add(a,s.neg()),r.color=n,r.addTriangle(f,c,l,n),r.addTriangle(c,l,h,n),r.addTriangle(f,l,c,n),r.addTriangle(c,h,l,n)}return r}},SQR.Quaternion=function(e,t,n,r){this.set(e,t,n,r)},SQR.Quaternion.prototype.set=function(e,t,n,r){this.w=e||1,this.x=t||0,this.y=n||0,this.z=r||0},SQR.Quaternion.prototype.copyFrom=function(e){this.w=e.w,this.x=e.x,this.y=e.y,this.z=e.z},SQR.Quaternion.prototype.identity=function(){this.set()},SQR.Quaternion.prototype.mul=function(e,t){return t=t||this,t.set(t.w*e.w-t.x*e.x-t.y*e.y-t.z*e.z,t.w*e.x+t.x*e.w+t.y*e.z-t.z*e.y,t.w*e.y-t.x*e.z+t.y*e.w+t.z*e.x,t.w*e.z+t.x*e.y-t.y*e.x+t.z*e.w),t.normalize(),t},SQR.Quaternion.prototype.lookAt=function(e,t){var n=SQR.Quaternion.__tv1,r=SQR.Quaternion.__tv2,i=SQR.Quaternion.__tv3;e.copyTo(n),t.copyTo(i),n.norm(),n.z==-1&&(n.x=1e-4,n.norm()),r.cross(i,n),i.cross(n,r),this.w=Math.sqrt(1+r.x+i.y+n.z)*.5;var s=4*this.w;return this.x=(n.y-i.z)/s,this.y=(r.z-n.x)/s,this.z=(i.x-r.y)/s,this.normalize(),this},SQR.Quaternion.prototype.fromAngleAxis=function(e,t,n,r){var i=Math.sin(e/2);this.x=t*i,this.y=n*i,this.z=r*i,this.w=Math.cos(e/2)},SQR.Quaternion.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},SQR.Quaternion.prototype.normalize=function(){var e=this.mag();this.x/=e,this.y/=e,this.z/=e,this.w/=e},SQR.Quaternion.prototype.toMatrix=function(){},SQR.Quaternion.slerp=function(e,t,n,r){r=r||new SQR.Quaternion;var i=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z,s=Math.acos(i),o=Math.sqrt(1-i*i),u=Math.sin((1-n)*s)/o;return n=Math.sin(n*s)/o,Math.abs(i)>=1?(u=1,n=0):Math.abs(o)<.001&&(n=u=.5),r.w=e.w*u+t.w*n,r.x=e.x*u+t.x*n,r.y=e.y*u+t.y*n,r.z=e.z*u+t.z*n,r},SQR.Spline=function(e,t,n,r){var i=this;this.rawPoints=[],this.controlPoints=[],this.length=0,this.samplingFreq=3e3;var s=1,o=4,u=!1;this.rawPoints.push(e,t,n,r),this.controlPoints.push(e,t,n,r);var a=new SQR.V2,f=function(e,t){return(new SQR.V2).sub(t,e).mul(.5).appendVec(e)},l=function(e,t,n){e=Math.max(e,0),e=Math.min(e,1);var r,o=i.controlPoints;return r=Math.floor(e*s),e=e*s-r,r==o.length/4&&(r=Math.max(0,r-1),e=1),r*=4,t=t||a,t.x=n(e,o[r+0].x,o[r+1].x,o[r+2].x,o[r+3].x),t.y=n(e,o[r+0].y,o[r+1].y,o[r+2].y,o[r+3].y),t};this.valueAt=function(e,t){return l(e,t,SQR.Interpolation.bezierPosition)},this.velocityAt=function(e,t){return l(e,t,SQR.Interpolation.bezierVelocity)},this.recalculateLength=function(e){e=e||this.samplingFreq;for(var t=0,n=new SQR.V2,r=0;r<=e;r++){var i=this.valueAt(r/e);r>0&&(t+=n.sub(i,n).mag()),n.copyFrom(i)}this.length=t},this.findTAtDistance=function(e,t,n){n=n||1/this.samplingFreq;for(var r=this.valueAt(e).clone(),i=0,s=new SQR.V2,o=0;i<t&&o<this.samplingFreq;){e+=n,e=Math.min(e,1);var u=this.valueAt(e);i+=s.sub(r,u).mag(),r.copyFrom(u),o++}return console.log(i,e),e},this.add=function(e,t){this.rawPoints.push(e,t),o=this.rawPoints.length,this.calculateControlPoints()},this.closePath=function(){u=!0,this.calculateControlPoints()},this.calculateControlPoints=function(){if(o<4||o%2==1)throw"Spline is corrupt - illegal number of points (should be an even number and >= 4)";this.controlPoints=[],s=1;for(var e=0;e<o;e++){var t=this.rawPoints[e];if(e<3)if(u&&e==0){var n=this.rawPoints[e+1];n=f(n,t),this.controlPoints.push(n)}else this.controlPoints.push(t);else e>=3&&e%2==0?this.controlPoints.push(t):e>=3&&e%2==1&&e==o-1&&!u?this.controlPoints.push(t):e>=3&&e%2==1&&e<o-1&&(n=this.rawPoints[e-1],n=f(t,n),this.controlPoints.push(n,n,t),s++)}if(u){e=this.rawPoints[this.rawPoints.length-1],t=this.rawPoints[0];var r=this.rawPoints[1];n=f(e,this.rawPoints[this.rawPoints.length-2]),r=f(t,r),this.controlPoints.push(n,n,e,t,r),s++}}},SQR.Spring=function(e){this.anchor=e||new SQR.V2,this.location=this.anchor.clone(),this.acceleration=this.anchor.clone(),this.velocity=this.anchor.clone(),this.friction=.85,this.k=.1;var t=0;this.update=function(){this.acceleration.sub(this.location,this.anchor),t=this.acceleration.mag(),this.acceleration.norm().mul(-this.k*t),this.velocity.add(this.velocity,this.acceleration),this.velocity.mul(this.friction),this.location.add(this.location,this.velocity)}},SQR.V2=function(e,t){this.x=e||0,this.y=t||0},SQR.V2.prototype.set=function(e,t){return this.x=e||0,this.y=t||0,this},SQR.V2.prototype.copyTo=function(e){e.x=this.x,e.y=this.y},SQR.V2.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this},SQR.V2.prototype.add=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},SQR.V2.prototype.sub=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},SQR.V2.prototype.neg=function(){return this.x*=-1,this.y*=-1,this},SQR.V2.prototype.appendVec=function(e){return e?(this.x+=e.x,this.y+=e.y,this):this},SQR.V2.prototype.mul=function(e,t){return t=t||this,t.x=this.x*e,t.y=this.y*e,t},SQR.V2.prototype.magsq=function(){return this.x*this.x+this.y*this.y},SQR.V2.prototype.mag=function(){return Math.sqrt(this.magsq())},SQR.V2.prototype.norm=function(){var e=this.mag();return e==0?this:(this.x/=e,this.y/=e,this)},SQR.V2.prototype.perpendicular=function(){var e=this.x;return this.x=-this.y,this.y=e,this},SQR.V2.prototype.isZero=function(){return this.x==0&&this.y==0},SQR.V2.random=function(){return new SQR.V2(Math.random()*2-1,Math.random()*2-1)},SQR.V2.prototype.setAngleRadius=function(e,t){return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},SQR.V2.prototype.append=function(e,t){return this.x+=e,this.y+=t,this},SQR.V2.prototype.addAngleRadius=function(e,t){return this.x+=Math.cos(e)*t,this.y+=Math.sin(e)*t,this},SQR.V2.prototype.clone=function(){return new SQR.V2(this.x,this.y)},SQR.V2.dot=function(e,t){return e.x*t.x+e.y*t.y},SQR.V3=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=r||1},SQR.V3.prototype.set=function(e,t,n,r){return this.x=e||0,this.y=t||0,this.z=n||0,this.w=r||1,this},SQR.V3.prototype.append=function(e,t,n,r){return this.x+=e||0,this.y+=t||0,this.z+=n||0,this.w+=r||0,this},SQR.V3.prototype.appendVec=function(e){return e?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):this},SQR.V3.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},SQR.V3.prototype.copy=function(e){return e=e||new SQR.V3,e.set(this.x,this.y,this.z,this.w),e},SQR.V3.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},SQR.V3.prototype.magsq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},SQR.V3.prototype.mag=function(){return Math.sqrt(this.magsq())},SQR.V3.prototype.isZero=function(){return this.x==0&&this.y==0&&this.z==0},SQR.V3.prototype.mul=function(e){return this.x*=e,this.y*=e,this.z*=e,this},SQR.V3.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},SQR.V3.prototype.norm=function(){var e=1/this.mag();return this.set(this.x*e,this.y*e,this.z*e),this},SQR.V3.prototype.add=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},SQR.V3.prototype.sub=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},SQR.V3.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},SQR.V3.prototype.clone=function(){return new SQR.V3(this.x,this.y,this.z)},SQR.V3.prototype.cross=function(e,t){return this.set(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x,this.w),this},SQR.V3.up=new SQR.V3(0,1,0),SQR.V3.forward=new SQR.V3(0,0,-1),SQR.VectorUtil={mouseToUnitSphereVector:function(e,t,n,r){return n=n||.5,r=r||new SQR.V3,e/=n,t/=n,n=e*e+t*t,n>=1?r.set(e,t,0):r.set(e,t,Math.sqrt(1-n)),r.norm(),r}},SQR.Quaternion.__tv1=new SQR.V3,SQR.Quaternion.__tv2=new SQR.V3,SQR.Quaternion.__tv3=new SQR.V3,SQR.Matrix2D.__temp=new Float32Array(9),SQR.Matrix33.__temp=new Float32Array(9),SQR.Matrix44.__temp=new Float32Array(16),SQR.Matrix44.__tv1=new SQR.V3,SQR.Matrix44.__tv2=new SQR.V3,SQR.Matrix44.__tv3=new SQR.V3,SQR.VectorUtil.__tv1=new SQR.V3,SQR.VectorUtil.__tv2=new SQR.V3,SQR.VectorUtil.__tv3=new SQR.V3,SQR.CSSCollider=function(e,t){function n(e,t,n,r){d.transformVector(e,t),t.x=t.x/t.z*n+n,t.y=t.y/t.z*r+r}var r=e*.5,i=t*.5,s=new SQR.V3(-r,i,0),o=new SQR.V3(r,i,0),u=new SQR.V3(r,-i,0),a=new SQR.V3(-r,-i,0),f=new SQR.V3,l=new SQR.V3,c=new SQR.V3,h=new SQR.V3,p=new SQR.V2,d=new SQR.Matrix44;this.project=function(e,t){t.projection.copyTo(d),d.multiply(e.viewMatrix),n(s,f,t.centerX,t.centerY),n(o,l,t.centerX,t.centerY),n(u,c,t.centerX,t.centerY),n(a,h,t.centerX,t.centerY)},this.intersects=function(e,t){p.set(e,t);var n=m(p,f,l,c),r=m(p,f,c,h);return n||r};var v=function(e,t,n){return(e.x-n.x)*(t.y-n.y)-(t.x-n.x)*(e.y-n.y)},m=function(e,t,n,r){var i=v(e,t,n)<0;return n=v(e,n,r)<0,e=v(e,r,t)<0,i==n&&n==e}},SQR.Particle=function(e){this.position=e=e||new SQR.V2,this.velocity=e.clone().set(),this.acceleration=e.clone().set(),this.angularAcceleration=this.angularVelocity=0,this.mass=1,this.friction=2,this.bounciness=1;var t=e.clone().set(),n=e.clone().set();this.addForce=function(e){t.copyFrom(e),t.mul(1/this.mass),this.acceleration.appendVec(t)},this.update=function(e){n.copyFrom(this.velocity),n.norm(),n.mul(-this.friction),this.addForce(n),this.acceleration.mul(e||1),this.velocity.appendVec(this.acceleration),this.position.appendVec(this.velocity),this.acceleration.set()}},SQR.DOMElement2D=function(e){this.isDom2d=!0,this.element=e;var t=!1,n=null,r=new SQR.Matrix2D,i=new SQR.Matrix44;this.appendToDom=function(e){t&&e==n||(n=e,n.appendChild(this.element),t=!0)},this.removeFromDom=function(){t&&(n.removeChild(this.element),t=!1)},this.setBackfaceVisibility=function(){},this.draw=function(t,n){n.projection.copyTo(i),i.multiply(t.viewMatrix);var s=new SQR.V3(0,0,0);i.transformVector(s),s.x=s.x/s.z*n.centerX,s.y=s.y/s.z*n.centerY;var o=1/(s.z/n.cssDistance);r.setTRS(s.x,s.y,t.rotation.z,o,o),o=(SQR.supportsCss3d?SQR.DOMUtil.translate3dCss(0,0,0):"")+r.getAsCSSProperty(!1),e.style.zIndex=n.depth,e.style.transform=o,e.style["-webkit-transform"]=o,e.style["-moz-transform"]=o,e.style["-o-transform"]=o,e.style["-ms-transform"]=o,e.style.display=s.z<=0?"none":"block"}},SQR.DOMElement3D=function(e){this.isDom3d=!0,this.element=e;var t=!1,n=null;this.setBackfaceVisibility=function(t){t=t?"visible":"hidden",e.style["backface-visibility"]=t,e.style["-webkit-backface-visibility"]=t,e.style["-moz-backface-visibility"]=t,e.style["-ms-backface-visibility"]=t,e.style["-o-backface-visibility"]=t},this.appendToDom=function(e){t&&e==n||(n=e,n.appendChild(this
.element),t=!0)},this.removeFromDom=function(){t&&(n.removeChild(this.element),t=!1)},this.draw=function(t,n){var r=SQR.DOMUtil.translate3dCss(0,0,n.cssDistance),i="perspective("+n.cssDistance+"px)";r=r+" "+t.viewMatrix.getAsCSSProperty(),e.style.transform=r,e.style["-webkit-transform"]=r,e.style["-moz-transform"]=r,e.style["-ms-transform"]=i+r,e.style["-o-transform"]=i+r,e.style.zIndex=n.depth}},SQR.Point=function(e){var t=new SQR.V3,n=new SQR.Matrix44;this.draw=function(r,i){var s=i.context,o=r.geometry;i.projection.copyTo(n),n.multiply(r.viewMatrix);for(var u=0;u<o.vertices.length;u++)if(o.vertices[u].copyTo(t),n.transformVector(t),!(t.z<0))t.x=t.x/t.z*i.centerX+i.centerX-e,t.y=t.y/t.z*i.centerY+i.centerY-e,s.drawImage(o.particleTextures[u],t.x,t.y)}},SQR.Polygon=function(){var e=new SQR.Matrix44;new SQR.V3,this.useLight=this.culling=!1,this.draw=function(t,n){var r=n.context,i=t.geometry;n.projection.copyTo(e),e.multiply(t.viewMatrix);var s,o,u=i.polygons.length;for(s=0;s<u;s++)o=i.polygons[s],o.update(e,n.centerX,n.centerY);i.polygons.sort(function(e,t){var n=e.depth,r=t.depth;return n<r?1:n>r?-1:0});for(s=0;s<u;s++)if(o=i.polygons[s],!(Math.max(0,SQR.V3.dot(o.normal,SQR.V3.forward))>0&&this.culling)){var f=Math.max(0,SQR.V3.dot(o.normal,n.lightDirection)),l=o.color||i.color;r.fillStyle=this.useLight?l.applyLight(f):l.toHSLString(),r.strokeStyle=this.useLight?l.applyLight(f):l.toHSLString(),r.beginPath(),r.moveTo(o.sa.x,o.sa.y),r.lineTo(o.sb.x,o.sb.y),r.lineTo(o.sc.x,o.sc.y),o.sd&&r.lineTo(o.sd.x,o.sd.y),r.closePath(),r.fill(),r.stroke()}}},SQR.Segment=function(e){var t=this;this.culling=!1;var n=new SQR.V3,r=new SQR.V3,i=new SQR.Matrix44,s=new SQR.V3(0,0,1),o=new SQR.V3;this.draw=function(u,l){var h=l.context,p=u.geometry;l.projection.copyTo(i),i.multiply(u.viewMatrix);var v=p.vertices.length;p.continous&&h.beginPath();for(var m=0;m<v;m++)if(!(!p.continous&&m%2==1||p.continous&&!p.closed&&m==v-1)){var y=m==v-1?0:m+1;p.vertices[m].copyTo(n),p.vertices[y].copyTo(r),h.strokeStyle=(p.colors?p.colors[m/2|0]:p.color).toHSLString(),h.lineWidth=e,y=n;var w=r,E=l.centerX,S=l.centerY;i.transformVector(y),i.transformVector(w),y.z<0||w.z<0?y=!1:(o.sub(y,w).norm(),SQR.V3.dot(o,s)<0&&t.culling?y=!1:(y.x=y.x/y.z*E+E,y.y=y.y/y.z*S+S,w.x=w.x/w.z*E+E,w.y=w.y/w.z*S+S,y=!0)),y&&(y=h,w=n,E=r,p.continous?m==0?y.moveTo(w.x,w.y):y.lineTo(w.x,w.y):(y.beginPath(),y.moveTo(w.x,w.y),y.lineTo(E.x,E.y),y.stroke()))}p.continous&&(p.closed&&h.closePath(),h.stroke())}},SQR.CanvasUtil={getPixel:function(e,t,n){return t=(n*e.width+t)*4,[e.data[t+0],e.data[t+1],e.data[t+2],e.data[t+3]]},setPixel:function(e,t,n,r,i,s,o){t=(n*e.width+t)*4,e.data[t+0]=r,e.data[t+1]=i,e.data[t+2]=s,e.data[t+3]=o},getPixelRed:function(e,t,n){return e.data[(n*e.width+t)*4]},getPixelAlpha:function(e,t,n){return e.data[(n*e.width+t)*4+3]},getPixelNormRed:function(e,t,n){return e.data[((n*(e.height-1)|0)*e.width+(t*(e.width-1)|0))*4]},rotateAround:function(e,t,n,r){e.translate(n,r),e.rotate(t),e.translate(-n,-r)}},SQR.Color=function(e,t,n,r){this.set=function(e,t,n,r){this.hue=e,this.saturation=t,this.lightness=n,this.alpha=r},this.applyLight=function(e){return SQR.Color.hsl(this.hue,this.saturation,this.lightness-60+80*e,this.alpha)},this.toHSLString=function(){return SQR.Color.hsl(this.hue,this.saturation,this.lightness,this.alpha)},this.set(e,t,n,r)},SQR.Color.hsl=function(e,t,n,r){return r?"hsla("+e+","+t+"%,"+n+"%, "+r+")":"hsl("+e+","+t+"%,"+n+"%)"},SQR.DOMUtil={translate3dCss:function(e,t,n){return" translate3d("+e+"px,"+t+"px,"+n+"px)"}},SQR.Interactor=function(){var e=this;this.centerY=this.centerX=this.normY=this.normX=this.absPageY=this.absPageX=this.pageY=this.pageX=0;var t=function(t){e.pageX=t.pageX,e.pageY=t.pageY,e.pageCenterX=t.pageX-window.innerWidth*.5,e.pageCenterY=t.pageY-window.innerHeight*.5,e.absPageX=t.clientX,e.absPageY=t.clientY,e.normX=t.pageX/window.innerWidth,e.normY=t.pageY/window.innerHeight,e.centerX=e.normX*2-1,e.centerY=e.normY*2-1};this.destroy=function(){document.removeEventListener("mousemove",t,null)},document.addEventListener("mousemove",t,null)},SQR.Stringify={v2:function(e){return e.x+" | "+e.y},v3:function(e){return e.x+" | "+e.y+" | "+e.z},q:function(e){return e.w+" || "+e.x+" | "+e.y+" | "+e.z},m33:function(e){return e=e.data||e,e[0]+"	|	"+e[1]+"	|	"+e[2]+"\n"+e[3]+"	|	"+e[4]+"	|	"+e[5]+"\n"+e[6]+"	|	"+e[7]+"	|	"+e[8]+"\n"},m44:function(e){var t=e.data||e;return e=function(e){return e=Math.abs(t[e])>1e-4?t[e]:0,e=e.toPrecision(3)},e(0)+"	|	"+e(4)+"	|	"+e(8)+"	|	"+e(12)+"\n"+e(1)+"	|	"+e(5)+"	|	"+e(9)+"	|	"+e(13)+"\n"+e(2)+"	|	"+e(6)+"	|	"+e(10)+"	|	"+e(14)+"\n"+e(3)+"	|	"+e(7)+"	|	"+e(11)+"	|	"+e(15)+"\n"}},SQR.Time={},SQR.Time.time=0,SQR.Time.startTime=0,SQR.Time.timeOffset=0,SQR.Time.lastTime=0,SQR.Time.deltaTime=0,SQR.Time.tick=function(){var e=(new Date).getTime();SQR.Time.startTime==0&&(SQR.Time.startTime=e),SQR.Time.lastTime!=0&&(SQR.Time.deltaTime=e-SQR.Time.lastTime),SQR.Time.lastTime=e,SQR.Time.time=(e-SQR.Time.startTime)/1e3,SQR.Time.deltaTime/=1e3},SQR.Time.getTime=function(){return SQR.Time.tick(),SQR.Time.deltaTime},SQR.Time.pause=function(){SQR.Time.timeOffset=(new Date).getTime()},SQR.Time.resume=function(){SQR.Time.startTime+=(new Date).getTime()-SQR.Time.timeOffset,SQR.Time.lastTime=SQR.Time.deltaTime=0},SQR.Time.formatTime=function(e,t){e||(e=SQR.Time.time);var n=Math.floor(e%1*100),r=Math.floor(e)%60,i=Math.floor(e/60);return n<10&&(n="0"+n),n==100&&(n="00"),r<10&&(r="0"+r),i<10&&(i="0"+i),t?i+":"+r+":"+n:i+":"+r};
// Original file: modernizr.js
window.Modernizr=function(e,t,n){function L(e){f.cssText=e}function A(e,t){return L(p.join(e+";")+(t||""))}function O(e,t){return typeof e===t}function M(e,t){return!!~(""+e).indexOf(t)}function _(e,t){for(var r in e){var i=e[r];if(!M(i,"-")&&f[i]!==n)return t=="pfx"?i:!0}return!1}function D(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n)return r===!1?e[i]:O(s,"function")?s.bind(r||t):s}return!1}function P(e,t,n){var r=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+v.join(r+" ")+r).split(" ");return O(t,"string")||O(t,"undefined")?_(i,t):(i=(e+" "+m.join(r+" ")+r).split(" "),D(i,t,n))}function H(){i.input=function(n){for(var r=0,i=n.length;r<i;r++)w[n[r]]=n[r]in l;return w.list&&(w.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),w}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),i.inputtypes=function(e){for(var r=0,i,s,u,a=e.length;r<a;r++)l.setAttribute("type",s=e[r]),i=l.type!=="text",i&&(l.value=c,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&l.style.WebkitAppearance!==n?(o.appendChild(l),u=t.defaultView,i=u.getComputedStyle&&u.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,o.removeChild(l)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=l.checkValidity&&l.checkValidity()===!1:i=l.value!=c)),b[e[r]]=!!i;return b}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.6.2",i={},s=!0,o=t.documentElement,u="modernizr",a=t.createElement(u),f=a.style,l=t.createElement("input"),c=":)",h={}.toString,p=" -webkit- -moz- -o- -ms- ".split(" "),d="Webkit Moz O ms",v=d.split(" "),m=d.toLowerCase().split(" "),g={svg:"http://www.w3.org/2000/svg"},y={},b={},w={},E=[],S=E.slice,x,T=function(e,n,r,i){var s,a,f,l,c=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(r,10))while(r--)f=t.createElement("div"),f.id=i?i[r]:u+(r+1),c.appendChild(f);return s=["&#173;",'<style id="s',u,'">',e,"</style>"].join(""),c.id=u,(h?c:p).innerHTML+=s,p.appendChild(c),h||(p.style.background="",p.style.overflow="hidden",l=o.style.overflow,o.style.overflow="hidden",o.appendChild(p)),a=n(c,e),h?c.parentNode.removeChild(c):(p.parentNode.removeChild(p),o.style.overflow=l),!!a},N=function(){function r(r,i){i=i||t.createElement(e[r]||"div"),r="on"+r;var s=r in i;return s||(i.setAttribute||(i=t.createElement("div")),i.setAttribute&&i.removeAttribute&&(i.setAttribute(r,""),s=O(i[r],"function"),O(i[r],"undefined")||(i[r]=n),i.removeAttribute(r))),i=null,s}var e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r}(),C={}.hasOwnProperty,k;!O(C,"undefined")&&!O(C.call,"undefined")?k=function(e,t){return C.call(e,t)}:k=function(e,t){return t in e&&O(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var r=S.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e,o=n.apply(s,r.concat(S.call(arguments)));return Object(o)===o?o:s}return n.apply(t,r.concat(S.call(arguments)))};return i}),y.flexbox=function(){return P("flexWrap")},y.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},y.canvastext=function(){return!!i.canvas&&!!O(t.createElement("canvas").getContext("2d").fillText,"function")},y.webgl=function(){return!!e.WebGLRenderingContext},y.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:T(["@media (",p.join("touch-enabled),("),u,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=e.offsetTop===9}),n},y.geolocation=function(){return"geolocation"in navigator},y.postmessage=function(){return!!e.postMessage},y.websqldatabase=function(){return!!e.openDatabase},y.indexedDB=function(){return!!P("indexedDB",e)},y.hashchange=function(){return N("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},y.history=function(){return!!e.history&&!!history.pushState},y.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},y.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},y.rgba=function(){return L("background-color:rgba(150,255,150,.5)"),M(f.backgroundColor,"rgba")},y.hsla=function(){return L("background-color:hsla(120,40%,100%,.5)"),M(f.backgroundColor,"rgba")||M(f.backgroundColor,"hsla")},y.multiplebgs=function(){return L("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(f.background)},y.backgroundsize=function(){return P("backgroundSize")},y.borderimage=function(){return P("borderImage")},y.borderradius=function(){return P("borderRadius")},y.boxshadow=function(){return P("boxShadow")},y.textshadow=function(){return t.createElement("div").style.textShadow===""},y.opacity=function(){return A("opacity:.55"),/^0.55$/.test(f.opacity)},y.cssanimations=function(){return P("animationName")},y.csscolumns=function(){return P("columnCount")},y.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return L((e+"-webkit- ".split(" ").join(t+e)+p.join(n+e)).slice(0,-e.length)),M(f.backgroundImage,"gradient")},y.cssreflections=function(){return P("boxReflect")},y.csstransforms=function(){return!!P("transform")},y.csstransforms3d=function(){var e=!!P("perspective");return e&&"webkitPerspective"in o.style&&T("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t,n){e=t.offsetLeft===9&&t.offsetHeight===3}),e},y.csstransitions=function(){return P("transition")},y.fontface=function(){var e;return T('@font-face {font-family:"font";src:url("https://")}',function(n,r){var i=t.getElementById("smodernizr"),s=i.sheet||i.styleSheet,o=s?s.cssRules&&s.cssRules[0]?s.cssRules[0].cssText:s.cssText||"":"";e=/src/i.test(o)&&o.indexOf(r.split(" ")[0])===0}),e},y.generatedcontent=function(){var e;return T(["#",u,"{font:0/0 a}#",u,':after{content:"',c,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},y.video=function(){var e=t.createElement("video"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(r){}return n},y.audio=function(){var e=t.createElement("audio"),n=!1;try{if(n=!!e.canPlayType)n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),n.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),n.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),n.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(r){}return n},y.localstorage=function(){try{return localStorage.setItem(u,u),localStorage.removeItem(u),!0}catch(e){return!1}},y.sessionstorage=function(){try{return sessionStorage.setItem(u,u),sessionStorage.removeItem(u),!0}catch(e){return!1}},y.webworkers=function(){return!!e.Worker},y.applicationcache=function(){return!!e.applicationCache},y.svg=function(){return!!t.createElementNS&&!!t.createElementNS(g.svg,"svg").createSVGRect},y.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==g.svg},y.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(h.call(t.createElementNS(g.svg,"animate")))},y.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(h.call(t.createElementNS(g.svg,"clipPath")))};for(var B in y)k(y,B)&&(x=B.toLowerCase(),i[x]=y[B](),E.push((i[x]?"":"no-")+x));return i.input||H(),i.addTest=function(e,t){if(typeof e=="object")for(var r in e)k(e,r)&&i.addTest(r,e[r]);else{e=e.toLowerCase();if(i[e]!==n)return i;t=typeof t=="function"?t():t,typeof s!="undefined"&&s&&(o.className+=" "+(t?"":"no-")+e),i[e]=t}return i},L(""),a=l=null,function(e,t){function l(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function c(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function h(e){var t=a[e[o]];return t||(t={},u++,e[o]=u,a[u]=t),t}function p(e,n,s){n||(n=t);if(f)return n.createElement(e);s||(s=h(n));var o;return s.cache[e]?o=s.cache[e].cloneNode():i.test(e)?o=(s.cache[e]=s.createElem(e)).cloneNode():o=s.createElem(e),o.canHaveChildren&&!r.test(e)?s.frag.appendChild(o):o}function d(e,n){e||(e=t);if(f)return e.createDocumentFragment();n=n||h(e);var r=n.frag.cloneNode(),i=0,s=c(),o=s.length;for(;i<o;i++)r.createElement(s[i]);return r}function v(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?p(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function m(e){e||(e=t);var n=h(e);return g.shivCSS&&!s&&!n.hasCSS&&(n.hasCSS=!!l(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),f||v(e,n),e}var n=e.html5||{},r=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,i=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,s,o="_html5shiv",u=0,a={},f;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",s="hidden"in e,f=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){s=!0,f=!0}})();var g={elements:n.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:n.shivCSS!==!1,supportsUnknownElements:f,shivMethods:n.shivMethods!==!1,type:"default",shivDocument:m,createElement:p,createDocumentFragment:d};e.html5=g,m(t)}(this,t),i._version=r,i._prefixes=p,i._domPrefixes=m,i._cssomPrefixes=v,i.hasEvent=N,i.testProp=function(e){return _([e])},i.testAllProps=P,i.testStyles=T,i.prefixed=function(e,t,n){return t?P(e,t,n):P(e,"pfx")},o.className=o.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(s?" js "+E.join(" "):""),i}(this,this.document),function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c=t.createElement(e),d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[]),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,u){var a=t(e),f=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]),a.instead?a.instead(e,i,s,o,u):(T[a.url]?a.noexec=!0:T[a.url]=1,s.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":n,a.noexec,a.attrs,a.timeout),(r(i)||r(f))&&s.load(function(){l(),i&&i(a.origUrl,u,o),f&&f(a.origUrl,u,o),T[a.url]=2})))}function u(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var a,f,c=this.yepnope.loader;if(i(e))o(e,0,c,0);else if(S(e))for(a=0;a<e.length;a++)f=e[a],i(f)?o(f,0,c,0):S(f)?k(f):Object(f)===f&&u(f,c);else Object(e)===e&&u(e,c)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
// Original file: spin.js
(function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(t):e.Spinner=t()})(this,function(){"use strict";function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,r,i,o){var u=["opacity",r,~~(e*100),i,o].join("-"),a=.01+i/o*100,f=Math.max(1-(1-e)/r*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(s.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",s.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;if(r[n]!==undefined)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function h(e){if(typeof this=="undefined")return new h(e);this.opts=f(e||{},h.defaults,c)}function p(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}s.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:s+" "+s,coordorigin:-r+" "+ -r}),{width:s,height:s})}function c(t,s,u){i(f,i(a(o(),{rotation:360/n.lines*t+"deg",left:~~s}),i(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:u}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,s=2*r,u=-(n.width+n.length)*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),l;if(n.shadow)for(l=1;l<=n.lines;l++)c(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)c(l);return i(t,f)},h.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,s=function(){var e=r("style",{type:"text/css"});return i(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),c={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};h.defaults={},f(h.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,s=t.el=a(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),o=i.radius+i.length+i.width,u,f;e&&(e.insertBefore(s,e.firstChild||null),f=l(e),u=l(s),a(s,{left:(i.left=="auto"?f.x-u.x+(e.offsetWidth>>1):parseInt(i.left,10)+o)+"px",top:(i.top=="auto"?f.y-u.y+(e.offsetHeight>>1):parseInt(i.top,10)+o)+"px"})),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var c=0,h=(i.lines-1)*(1-i.direction)/2,p,d=i.fps,v=d/i.speed,m=(1-i.opacity)/(v*i.trail/100),g=v/i.lines;(function y(){c++;for(var e=0;e<i.lines;e++)p=Math.max(1-(c+(i.lines-e)*g)%v*m,i.opacity),t.opacity(s,e*i.direction+h,p,i);t.timeout=t.el&&setTimeout(y,~~(1e3/d))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function l(e,n){return a(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*s+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var s=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;s<t.lines;s++)f=a(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+s*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(f,a(l("#000","0 0 4px #000"),{top:"2px"})),i(e,i(f,l(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var d=a(r("group"),{behavior:"url(#default#VML)"});return!u(d,"transform")&&d.adj?p():n=u(d,"animation"),h});
// Original file: ProductionConsole.js
function debug(e){e?console=consoleHolder:(consoleHolder=console,console=function(){},console.log=function(){})}var consoleHolder=console;debug(!1);
// Original file: _FJ.js
var FJ=FJ||{};FJ.NOTIF_EVENT="fjEvent",FJ.NOTIF_NAVIGATION="fjNavigation",FJ.MSG_NAVIGATE="fjNavigate",FJ.MSG_NAVIGATE_UNDO="fjNavigateUndo",FJ.MSG_NAVIGATE_REDO="fjNavigateRedo";
// Original file: CSSTransitionBehavior.js
FJ.CSSTransitionBehavior=function(e,t,n){function o(){var t=[];for(var n in s){var r="";r+=n+" ",r+=s[n].duration+"ms ",r+=s[n].delay+"ms ",r+=s[n].ease,t.push(r)}e.style[i+"transition"]=t.join(",")}t=t||{};var r=t.transition={},i="",s={};return n!=undefined?i="-"+n+"-":FJ.Capabilities.vendor!=undefined&&(i=FJ.Capabilities.vendor),r.set=function(e,t,n,r,i){var u=t||300,a=n||0;s[e]={},s[e].duration=u,s[e].delay=a,s[e].ease=r||FJ.ANIM.EASE,o(),i&&setTimeout(function(){i()},u+a)},r.setPrefixed=function(e,t,n,s){r.set(i+e,t,n,s)},FJ.define(r,"properties",function(){return s}),t},FJ.ANIM={};var cb="cubic-bezier(";FJ.ANIM.cubicBezier=function(e,t,n,r){return cb+e+", "+t+", "+n+", "+r+")"},FJ.ANIM.EASE_IN_OUT="ease-in-out",FJ.ANIM.EASE_OUT="ease-out",FJ.ANIM.EASE_IN="ease-in",FJ.ANIM.EASE="ease",FJ.ANIM.LINEAR="linear",FJ.ANIM.BACK_IN=cb+"1, -1, .25, 1.25)",FJ.ANIM.BACK_OUT=cb+".75, -0.25, 0, 2)",FJ.ANIM.STUTTER_IN=cb+"0, .29, 1, -0.36)";
// Original file: CSSTransformBehavior.js
FJ.CSSTransformBehavior=function(e,t){function a(){e.style[i+"transform"]=s.toString()}function f(e){var t=/([a-z].*)/g;return t.exec(e)[0]}t=t||{},t.transform={};var n=t.transform,r=FJ.Capabilities.csstransforms,i=FJ.Capabilities.vendor||"",s={translateZ:undefined,translateX:undefined,translateY:undefined,skewX:undefined,skewY:undefined,scaleX:undefined,scaleY:undefined,rotate:undefined,rotateX:undefined,rotateY:undefined,rotateZ:undefined,toString:function(){var e="";for(var t in this)this[t]!=undefined&&typeof this[t]!="function"&&(e+=t+"("+this[t]+") ");return e}};n.transforms=function(){return s},FJ.Capabilities.csstransforms3d&&(s.translateZ=0);var o="50%",u="50%";return FJ.define(n,"origin",function(){return _origin},function(t,n){o=t,u=n,e.style[i+"transform-origin"]=o+" "+u}),r?(n.translate=function(e,t,n){s.translateX=e+"px",s.translateY=t+"px",s.translateZ=n+"px",a()},FJ.define(n,"x",function(){return s.translateX=s.translateX||"0",parseFloat(s.translateX.split("px")[0])},function(e){s.translateX=e+"px",a()}),FJ.define(n,"y",function(){return s.translateY=s.translateY||"0",parseFloat(s.translateY.split("px")[0])},function(e){s.translateY=e+"px",a()}),FJ.define(n,"z",function(){return s.translateZ=s.translateZ||"0",parseFloat(s.translateZ.split("px")[0])},function(e){s.translateZ=e+"px",a()})):(n.translate=function(t,n){e.style.left=t+"px",e.style.top=n+"px"},FJ.define(n,"x",function(){return parseFloat(e.style.left.split("px")[0])},function(t){e.style.left=t+"px"}),FJ.define(n,"y",function(){return parseFloat(e.style.top.split("px")[0])},function(t){e.style.top=t+"px"})),FJ.define(n,"rotate",function(){s.rotate=s.rotate||"0";var e=/([a-z].*)/g,t=e.exec(s.rotate)[0];return parseFloat(s.rotate.split(t)[0])},function(e,t){t=t||"deg",s.rotate=e+t,a()}),n.scale=function(e,t){s.scaleX=e,s.scaleY=t,a()},FJ.define(n,"scaleX",function(){return s.scaleX=s.scaleX||"1",parseFloat(s.scaleX)},function(e){s.scaleX=e,a()}),FJ.define(n,"scaleY",function(){return s.scaleY=s.scaleY||"1",parseFloat(s.scaleY)},function(e){s.scaleY=e,a()}),n.skew=function(e,t,n){n=n||"deg",s.skewX=e+n,s.skewY=t+n,a()},n.rotate3D=function(e,t,n,r){r=r||"deg",s.rotateX=e+r,s.rotateY=t+r,s.rotateZ=n+r,a()},FJ.define(n,"skewX",function(){var e=f(s.skewX);return parseFloat(s.skewX.split(e)[0])},function(e,t){t=t||"deg",s.skewX=e+t,a()}),FJ.define(n,"skewY",function(){var e=f(s.skewY);return parseFloat(s.skewY.split(e)[0])},function(e){var t=t||"deg";s.skewY=e+t,a()}),t};
// Original file: CSSAnimationBehavior.js
FJ.CSSAnimationBehavior=function(e,t,n){this.resetAfterAnimation=!1,n||(console.log("CSSAnimationBehavior created outside of constructor"),t&&console.warn("### #### #### --- --- resetAfterAnimation = true"),this.resetAfterAnimation=t,console.trace()),e.animation={};var r=e.animation,i=e.div.style,s=FJ.Capabilities.vendor;return s=s.substring(1,s.length-1),r.set=function(e,t,n,o,u,f){o=o||0;var l=(t+o)*1e3,c=e+" "+t+"s "+n+" "+o+"s";i.animation=c,i[s+"Animation"]=c,f&&(i[s+"AnimationFillMode"]=f,i.animationFillMode=f),(u||this.resetAfterAnimation)&&setTimeout(function(){this.resetAfterAnimation&&r.reset(),u&&u()},l)},r.reset=function(){i.animation="",i.animationFillMode="",i[s+"Animation"]="",i[s+"AnimationFillMode"]=""},r};
// Original file: Application.js
FJ.Application=new function(){var e=this,t=[];this.model={},this.slug="",this.init=function(t){FJ.Router.init(),FJ.Router.start(t),e.broadcast(FJ.Router.navigateBySlug)},this.createMediator=function(e){e=e||"mediator"+t.length;var n=new FJ.Mediator(e,this);return t.push(n),n},this.destroyMediator=function(e){var n=t.indexOf(e);if(n<0)return;t.splice(n,1)},this.registerViews=function(){for(var e=0,t=arguments.length;e<t;e++){arguments[e].register();var n=arguments[e].onRegister;n&&n()}},this.broadcast=function(e){var n=t.length;for(var r=0;r<n;r++)t[r].notify(e)}};
// Original file: EventDispatcher.js
FJ.EventDispatcher=function(e){var t=[];this.addEventListener=function(n){if(t.indexOf(n)>-1)return;t.push(n),e&&e(t.length)},this.removeEventListener=function(n){var r=t.indexOf(n);return r<0?null:(e&&e(t.length-1),t.splice(r,1))},this.dispatch=function(e){var n=t.length;for(var r=0;r<n;r++)t[r](e)}};
// Original file: Mediator.js
FJ.Mediator=function(e){this.name=e,this.notify=function(e){this.update&&this.update(e)}};
// Original file: Notification.js
FJ.Notification=function(e,t,n){if(!e)throw"NOTIFICATION ERROR. Message cannot be null";if(t==FJ.NOTIF_NAVIGATION&&!n)throw"NOTIFICATION ERROR. Navigation type notifications require a slug";this.message=e,this.vars=null,this.type=t||FJ.NOTIF_EVENT,this.slug=n||"",this.action=null,this.postAction=null;var r=this;this.send=function(){FJ.Application.broadcast(r)}};
// Original file: Router.js
FJ.Router=new function(){"use strict";var e=this,t=" ",n=100,r=document.location.href,i=r.indexOf("#"),s=i>0?r.substring(0,i):r,o=function(){var e=r.indexOf("#");if(e!=-1)var n=2+(r.indexOf("#!")==-1?0:1);else n=2;var i=r.substring(e+n);return e>0&&e!=r.length-1?i:t},u=function(e){FJ.Application.slug=e,r=s+"#!/"+e,document.location.href=r};this.start=function(i){t=i,e.navigateBySlug=new FJ.Notification(FJ.MSG_NAVIGATE,FJ.NOTIF_NAVIGATION,o()),setInterval(function(){document.location.href!=r&&(r=document.location.href,e.navigateBySlug.slug=o(),FJ.Application.broadcast(e.navigateBySlug))},n)},this.init=function(){FJ.Application.createMediator("router").update=function(e){e.type==FJ.NOTIF_NAVIGATION&&u(e.slug)}}};
// Original file: DisplayUtil.js
FJ.DisplayUtil={},FJ.DisplayUtil.getWidth=function(e){return e.offsetWidth},FJ.DisplayUtil.getHeight=function(e){return e.offsetHeight},FJ.DisplayUtil.byId=function(e){return document.getElementById(e)},FJ.DisplayUtil.rmAllChildren=function(e){var t=typeof e=="string"?document.getElementById(e):e;t.innerHTML="";while(t.hasChildNodes())t.removeChild(t.firstChild)},FJ.DisplayUtil.rmChild=function(e){var t=typeof e=="string"?document.getElementById(e):e;t&&t.parentNode&&t.parentNode.removeChild&&t.parentNode.removeChild(t)},FJ.DisplayUtil.rmChildAndChildren=function(e){FJ.DisplayUtil.rmAllChildren(e),FJ.DisplayUtil.rmChild(e)},FJ.DisplayUtil.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},FJ.DisplayUtil.addClass=function(e,t){FJ.DisplayUtil.hasClass(e,t)||(e.className+=" "+t)},FJ.DisplayUtil.removeClass=function(e,t){if(FJ.DisplayUtil.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}};
// Original file: ViewportUtil.js
FJ.ViewportUtil={},FJ.ViewportUtil.getViewportDimensions=function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}};
// Original file: Capabilities.js
FJ.Capabilities=function(){var e={};if(Modernizr==undefined)throw Error("Modernizr is required");e=Modernizr;var t="",n="",r=["webkit","moz","ms"],i=Modernizr.prefixed("transform").toLowerCase();for(var s=0;s<r.length;s++)i.split("transform")[0]==r[s]&&(t="-"+r[s]+"-",n=r[s],n=="moz"&&(n="Moz"));return e.vendor=t,e.vendorNodash=n,e.isMobile=e.touch,e}();
// Original file: Extensions.js
(function(e,t){var n="",r,i,s;e.addEventListener?(r="addEventListener",i="removeEventListener"):(r="attachEvent",i="detachEvent",n="on"),t.onmousewheel!==undefined&&(s="mousewheel");try{WheelEvent("wheel"),s="wheel"}catch(o){}s||(s="DOMMouseScroll"),e.addWheelListener=function(e,t,i){var o=s=="wheel"?t:u(t);return e[r](n+s,o,i||!1),s=="DOMMouseScroll"&&e[r]("MozMousePixelScroll",o,i||!1),o},e.removeWheelListener=function(e,t){e[i](n+s,t),s=="DOMMouseScroll"&&e[i]("MozMousePixelScroll",t)};var u=function(t){return function(n){!n&&(n=e.event);var r={originalEvent:n,target:n.target||n.srcElement,type:"wheel",deltaMode:n.type=="MozMousePixelScroll"?0:1,deltaX:0,deltaY:0,preventDefault:function(){n.preventDefault?n.preventDefault():n.returnValue=!1}};return s=="mousewheel"?(r.deltaY=-n.wheelDelta/10,n.wheelDeltaX&&(r.deltaX=-n.wheelDeltaX/10)):r.deltaY=n.detail,r.deltaX=r.deltaX|0,r.deltaY=r.deltaY|0,t(r)}}})(window,document),function(){var e=0,t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);return e=r+i,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=t||0,r=this.length;n<r;n++)if(this[n]===e)return n;return-1}),(!window.console||!console.log)&&function(){var e=function(){},t=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","markTimeline","table","time","timeEnd","timeStamp","trace","warn"],n=t.length,r=window.console={};while(n--)r[t[n]]=e}();
// Original file: Slug.js
FJ.Slug=function(e){var t="/";this.parts=e.split(t);var n=this.parts.length;n>1&&this.parts[0]==""&&this.parts.shift(),this.head=this.parts[0],this.values={};if(n>1){var r=(n-1)/2|0;for(var i=0;i<r;i++){var s=this.parts[1+i*2],o=this.parts[1+i*2+1];this.values[s]=o}}this.isHeadOnly=function(){return n==1}};
// Original file: ArrayUtil.js
FJ.ArrayUtil={apply:function(e,t){var n=e.length;for(var r=0;r<n;r++)e[r][t]()},applyOn:function(e,t){var n=e.length;for(var r=0;r<n;r++)e[r]=t(e[r],r)},applyWithCallback:function(e,t,n){var r=e.length,i=r,s=function(){i--,i<=0&&n()};for(var o=0;o<r;o++)e[o][t](s)}},Array.prototype.shuffle=function(){var e=this.length,t,n,r;if(e==0)return this;while(--e)t=Math.floor(Math.random()*(e+1)),n=this[e],r=this[t],this[e]=r,this[t]=n;return this},String.prototype.line=function(e){return this.split("\n")[e]},Number.prototype.pad=function(e,t){return Array(e-String(this).length+1).join(t||"0")+this};
// Original file: MathUtil.js
FJ.MathUtil={step:function(e,t){return t>=e?1:0},minWithSign:function(e,t){var n=e<0?-1:1,r=Math.min(Math.abs(e),t);return r*n},maxWithSign:function(e,t){var n=e<0?-1:1,r=Math.max(Math.abs(e),t);return r*n},clamp:function(e,t,n){return n<e?e:n>t?t:n},smoothStep:function(e,t,n){return n<=e?e:n>=t?t:(n=(n-e)/(t-e),e+(t-e)*(3*n*n-2*n*n*n))},easeQuadInOut:function(e,t,n){return(n*=2)<1?e+(t-e)*.5*n*n:e+(t-e)*-0.5*(--n*(n-2)-1)},easeQuadOut:function(e,t,n){return e+(t-e)*n*(2-n)}};
// Original file: VirtualScroll.js
FJ.VirtualScroll=function(e,t){var n=1;Browsers.chrome()&&(n=2),Browsers.ie()&&(n=4),FJ.Capabilities.touch&&(n=2);var r=this;this.event={scrollX:0,scrollY:0,targetScrollX:0,targetScrollY:0,deltaX:0,deltaY:0,maxDeltaX:0,maxDeltaY:0};var i=0,s=0,o=!1,u=!1,a,f,l,c,h,p;this.dispatcher=new FJ.EventDispatcher(function(e){e>0&&!o?(S(),o=!0):e==0&&o&&(x(),o=!1)});var d=null,v=null,m=null,g=null;this.limitX=function(e,t){d=e,v=t},this.limitY=function(e,t){m=e,g=t},this.reset=function(){r.setValue(0,0)},this.setValue=function(e,t){r.event.scrollX=e,r.event.scrollY=t,r.event.targetScrollX=e,r.event.targetScrollY=t,u=!1},this.scrollTo=function(e,t,n){u=!0,a=r.event.scrollX,f=r.event.scrollY,r.event.targetScrollX=e,r.event.targetScrollY=t,h=n||30,p=0};var y=function(){p++;var e=FJ.MathUtil.easeQuadOut(a,r.event.targetScrollX,p/h),t=FJ.MathUtil.easeQuadOut(f,r.event.targetScrollY,p/h);b(e-r.event.scrollX,t-r.event.scrollY),p>=h&&(u=!1)},b=function(e,n){t&&!u?(r.event.targetScrollX+=e,r.event.targetScrollY+=n):(r.event.scrollX+=e,r.event.scrollY+=n),r.event.maxDeltaX=Math.max(r.event.maxDeltaX,Math.abs(e)),r.event.maxDeltaY=Math.max(r.event.maxDeltaY,Math.abs(n)),r.event.deltaX=e,r.event.deltaY=n},w;this.touch=function(){E()};var E=function(){d!=null&&(r.event.scrollX=FJ.MathUtil.clamp(d,v,r.event.scrollX),r.event.targetScrollX=FJ.MathUtil.clamp(d,v,r.event.targetScrollX)),m!=null&&(r.event.scrollY=FJ.MathUtil.clamp(m,g,r.event.scrollY),r.event.targetScrollY=FJ.MathUtil.clamp(m,g,r.event.targetScrollY)),r.dispatcher.dispatch(r.event)},S=function(){FJ.Capabilities.touch?(document.addEventListener("touchstart",C,!1),document.addEventListener("touchmove",k,!1)):w=addWheelListener(document,N,!1),FJ.FrameImpulse.addEventListener(T)},x=function(){removeWheelListener(document,w),document.removeEventListener("touchstart",C),document.removeEventListener("touchmove",k)},T=function(){u?y():t&&(r.event.scrollX+=(r.event.targetScrollX-r.event.scrollX)*t,r.event.scrollY+=(r.event.targetScrollY-r.event.scrollY)*t),E()},N=function(e){u=!1;var t=e.deltaY==e.deltaY>>0?e.deltaY:e.deltaY*e.deltaY*e.deltaY,r=e.deltaX==e.deltaX>>0?e.deltaX:e.deltaX*e.deltaX*e.deltaX;b(r*n,t*n)},C=function(e){i=0,s=0},k=function(e){e.preventDefault(),u=!1,i!=0&&b(-(e.targetTouches[0].pageX-i)*n,-(e.targetTouches[0].pageY-s)*n),i=e.targetTouches[0].pageX,s=e.targetTouches[0].pageY}};
// Original file: Define.js
FJ.define=function(e,t,n,r){e[t]=function(){if(arguments.length<1)return n();r&&r.apply(this,arguments)}};
// Original file: ElementWrapper.js
FJ.ElementWrapper=function(e){var t=this,n=FJ.Capabilities.vendor,r=FJ.Capabilities.vendorNodash;e?t.div=e:t.div=document.createElement("div"),FJ.define(this,"id",function(){return t.div.id},function(e){t.div.id=e}),FJ.define(this,"class",function(){return t.div.className},function(e){t.div.className=e}),this.setTransform=function(e){console.warn("DEPRECATED setTransform"),console.trace(),t.div.style[n+"transform"]=e},this.setTransformGPU=function(e){console.warn("DEPRECATED setTransformGPU"),console.trace(),t.div.style[n+"transform"]="translateZ(0) "+e},this.translate=function(e,n,i,s){e=e||0,n=n||0,i=i||0,s=s||"";var o=r==""?"transform":r+"Transform";if(FJ.Capabilities.csstransform3d){var u="translate3d("+e+"px, "+n+"px, "+i+"px) "+s;t.div.style[o]=u}else t.div.style[o]="translate("+e+"px, "+n+"px)"},this.setDisplay=function(e){t.div.style.display=e},this.opacity=function(e){t.div.style.opacity=e},this.registerClick=function(e){t.div.addEventListener("click",e)},this.unRegisterClick=function(e){t.div.addEventListener("click",e)},this.width=function(){return t.div.offsetWidth},this.height=function(){return t.div.offsetHeight},this.mouseEnabled=function(e){t.div.style["pointer-events"]=e?"auto":"none"},new FJ.CSSTransformBehavior(this.div,this),new FJ.CSSTransitionBehavior(this.div,this),new FJ.CSSAnimationBehavior(this,!1,!0)};
// Original file: Sprite.js
FJ.View=function(e,t){"use strict";var n=this,r=e;this.div=document.createElement(t||"div"),this.visible=!1,FJ.ElementWrapper.call(this),this.show=function(){n.visible||r.appendChild(n.div),n.visible=!0},this.hide=function(){n.visible&&r.removeChild(n.div),n.visible=!1},this.add=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];t.visible=!0,this.contains(t)||this.div.appendChild(t.div)}},this.contains=function(e){return e.div.parentNode==this.div},this.remove=function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];t.visible=!1,this.contains(t)&&this.div.removeChild(t.div)}},this.removeAll=function(){this.div.innerHTML=""}},FJ.View.prototype=new FJ.ElementWrapper,FJ.View.prototype.constructor=FJ.ElementWrapper;
// Original file: Template.js
FJ.Template=function(templateString){var TemplateFunctions=function(e){this.exists=function(t){return e[t]!=undefined&&e[t]!=null&&!!e[t]&&e[t].length!=0},this.displayForUndefined=function(t){return e[t]==undefined||e[t]==null||!e[t]||e[t].length==0?"style='display: none;'":""}};this.execute=function(element,params){params._template&&console.warn("Template: params has a _template property defined. It will be overridden!"),params._template=new TemplateFunctions(params);var ct=templateString.split("\n").join("");for(var p in params)if(typeof params[p]=="object"){var pattern=new RegExp("%for[(]"+p+"[)]%(.*?)%for%","g"),me=new RegExp("this","g"),match,matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++){match=matches[i];var l=params[p],r="",c=match[1];for(var j=0;j<l.length;j++)r+=c.replace(me,""+p+"["+j+"]");ct=ct.replace(match[0],r)}}for(var p in params)if(typeof params[p]=="boolean"||typeof params[p]=="object"){var pattern=new RegExp("%if[(]"+p+"([.|[][^%]*)[)]%","g"),match,matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++){match=matches[i];var code="params[p]"+match[1],res;try{res=eval(code),res=res==undefined||res==0?"false":"true"}catch(e){throw"TEMPLATE ERROR. Unable to call "+match[1]+" on '"+params[p]+"' ("+e+")"}ct=ct.replace(match[0],"%if("+res+")%")}pattern=new RegExp("%if[(]"+p+"[)]%","g"),matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++)ct=ct.replace(matches[i][0],"%if("+params[p]+")%");var pattern=new RegExp("%if[(]true[)]%(.*?)%if%","g"),match,matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++)ct=ct.replace(matches[i][0],matches[i][1]);var pattern=new RegExp("%if[(]false[)]%(.*?)%if%","g"),match,matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++)ct=ct.replace(matches[i][0],"")}for(var p in params)if(typeof params[p]=="string"||typeof params[p]=="object"){var pattern=new RegExp("%"+p+"([.|[][^%]*)%","g"),match,matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++){match=matches[i];var code="params[p]"+match[1],res;try{res=eval(code)}catch(e){throw"TEMPLATE ERROR. Unable to call "+match[1]+" on '"+params[p]+"' ("+e+")"}ct=ct.replace(match[0],res)}pattern=new RegExp("%"+p+"%","g"),matches=[];while((match=pattern.exec(ct))!==null)matches.push(match);for(var i=0;i<matches.length;i++)ct=ct.replace(matches[i][0],params[p])}return element&&(element.innerHTML=ct),params._template=null,ct}};
// Original file: Loader.js
var FJ=FJ||{};FJ.Loader=FJ||{},FJ.Loader.loadJSON=function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){n.readyState==4&&t(JSON.parse(n.responseText))},n.send()},window.__loadCount=0,FJ.Loader.loadJSONP=function(e,t){var n=document.createElement("script");t!=undefined&&(e+="&callback=__loaded"+window.__loadCount),n.src=e,document.body.appendChild(n),t!=undefined&&(window["__loaded"+window.__loadCount]=function(n){try{t(n)}catch(r){throw Error("error loading",e,r)}},window.__loadCount++)},FJ.Loader.loadPlainText=function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){n.readyState==4&&t(n.responseText)},n.send()},FJ.Loader.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.onload=t,n.src=e,document.body.appendChild(n)},FJ.Loader.loadLink=function(e,t){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/"+e.split(".")[1]),n.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(n),t&&t()},FJ.Loader.loadFramework=function(e,t){var n=["behaviors/CSSTransitionBehavior.js","behaviors/CSSTransformBehavior.js","core/Application.js","core/EventDispatcher.js","core/Mediator.js","core/Notification.js","core/Router.js","util/display/DisplayUtil.js","util/viewport/ViewportUtil.js","util/Capabilities.js","util/Define.js","util/Extensions.js","util/FrameImpulse.js","util/ImageDataUtil.js","util/MathUtil.js","util/Slug.js","util/VirtualScroll.js","view/ElementWrapper.js","view/Sprite.js","view/Template.js"];FJ.Loader.loadScript(e+"_FJ.js",function(){var r=n.length;for(var i=0;i<n.length;i++)FJ.Loader.loadScript(e+n[i],function(){r--,r==0&&t()})})};
// Original file: FrameImpulse.js
FJ.FrameImpulse=function(){window.requestAnimFrame=window.requestAnimFrame||function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var e=new FJ.EventDispatcher,t={};t.frameNum=0;var n=function(){requestAnimFrame(n),t.frameNum++,e.dispatch(t)};return n(),e}();
// Original file: Tool.js
var Tool={init:function(){console.log("Tool.init()");var e=function(){Browsers.init(),Tool.Actions.PREVIEW_MODE=document.location.search.indexOf("preview")>-1;var e=document.createElement("div");e.id="rootView",document.body.appendChild(e),FJ.Application.model=FJ.Application.model||{},FJ.Application.model.data={};if(!Browsers.mobile())new Navi(Tool.Actions.V_NAVI,e),new CloseButton(Tool.Actions.V_CLOSE_BTN,e),new BufferingInfo(Tool.Actions.V_BUFFERING,e),new Subnavi(Tool.Actions.V_SUBNAVI,e),new WorkSubnavi(Tool.Actions.V_SUBNAVI,e),new SoftSubnavi(Tool.Actions.V_SUBNAVI,e),new Home(Tool.Actions.V_HOME,e),new Reel(Tool.Actions.V_HOME,e),new WorkList(Tool.Actions.V_WRK,e),new WorkItem(Tool.Actions.V_WRK,e),new Directors(Tool.Actions.V_DIR,e),new DirectorsList(Tool.Actions.V_DIR,e),new DirectorItem(Tool.Actions.V_DIR_ITEM,e),new DirectorReel(Tool.Actions.V_DIR_REEL,e),new Awards(Tool.Actions.V_AWD,e),new About(Tool.Actions.V_ABT,e),new Contact(Tool.Actions.V_CNT,e),new SmallWindow("",e);else{if(!Modernizr.csstransforms||Modernizr.video.h264==""&&Modernizr.video.ogg==""&&Modernizr.video.webm=="")window.location.href=window.location.href.split("/#")[0]+"/unsupported/m";new NaviMobile(Tool.Actions.V_NAVI,e),new HomeMobile(Tool.Actions.V_HOME,e),new WorkMobile(Tool.Actions.V_WRK,e),new WorkTagListMobile(Tool.Actions.V_WRK,e),new DirectorsMobile(Tool.Actions.V_DIR,e),new DirectorPageMobile(Tool.Actions.V_DIR_ITEM,e),new AwardsMobile(Tool.Actions.V_AWD,e),new AboutMobile(Tool.Actions.V_ABT,e),new ConnectMobile(Tool.Actions.V_CNT,e),document.getElementsByTagName("html")[0].classList.add("mobile"),ScrollController.disableTouchMove()}new ScreenSize,new RedirectService,new DataService,new Analytics,FJ.Application.broadcast(new FJ.Notification(Tool.Actions.MSG_INIT_DATA))},t=typeof Navi=="undefined";console.log("- isMobile: ",Browsers.mobile()),console.log("- production: ",t),Modernizr.touch&&(console.log("Locking elastic scroll"),document.addEventListener("touchmove",function(e){e.preventDefault()})),t?Browsers.mobile()?(FJ.Loader.loadLink("css/compiled/mobile.css"),FJ.Loader.loadScript("js/mobile_min.js",e)):(FJ.Loader.loadLink("css/compiled/desktop.css"),FJ.Loader.loadScript("js/desktop_min.js",e)):e()}};
// Original file: Const.js
Tool.Actions={MENU_HEIGHT:50,VISIBILITY_THRESHOLD:720,MOBILE_THRESHOLD:720,TABLET_THRESHOLD:1024,NARROW_LAYOUT_THRESHOLD:1280,V_NAVI:"navi",V_SUBNAVI:"subnavi",V_CLOSE_BTN:"closebtn",V_BUFFERING:"buffering",V_HOME:"home",V_WRK:"work",V_DIR:"directors",V_DIR_ITEM:"director",V_AWD:"awards",V_ABT:"about",V_CNT:"contact",V_TAG:"tag",V_DEFAULT_TAG:"featured",V_CASESTUDY:"more-video",V_VIDEO:"video",V_DIR_REEL:"reel",TP_NAVI:"data/templates/desktop/navigation.html",TP_HOME:"data/templates/desktop/home.html",TP_WORK:"data/templates/desktop/work.html",TP_WORK_ITEM:"data/templates/desktop/work_item.html",TP_DIR:"data/templates/desktop/directors.html",TP_DIR_LIST:"data/templates/desktop/directors_list.html",TP_DIR_ITEM:"data/templates/desktop/director_item.html",TP_AWARDS:"data/templates/desktop/awards.html",TP_ABOUT:"data/templates/desktop/about.html",TP_CONNECT:"data/templates/desktop/connect.html",TP_NAVI_MOBILE:"data/templates/mobile/navi.html",TP_HOME_MOBILE:"data/templates/mobile/home.html",TP_AWARDS_MOBILE:"data/templates/mobile/awards.html",TP_AWARDS_MOBILE_PROJECT:"data/templates/mobile/awards-project.html",TP_CONNECT_MOBILE:"data/templates/mobile/connect.html",TP_DIR_MOBILE:"data/templates/mobile/directors.html",TP_DIR_PAGE_MOBILE:"data/templates/mobile/director.html",TP_ABOUT_MOBILE:"data/templates/mobile/about.html",TP_WORK_MOBILE:"data/templates/mobile/work.html",TP_TAGGED_ITEM:"data/templates/mobile/work_tagged-project.html",DT_INIT:"data/proxy.php?url=http://toolofnadrive.com/cms/api/index.php?f=sections",DT_HOME:"data/proxy.php?url=http://toolofnadrive.com/cms/api/index.php?f=home",DT_WORK:"data/proxy.php?url=http://toolofnadrive.com/cms/api/projects.php",DT_PROJECT:"data/proxy.php?url=http://toolofnadrive.com/cms/api/projects.php",DT_DIRECTORS:"data/proxy.php?url=http://toolofnadrive.com/cms/api/directors.php",DT_DIRECTOR_ITEM:"data/proxy.php?url=http://toolofnadrive.com/cms/api/directors.php",DT_AWARDS:"data/proxy.php?url=http://toolofnadrive.com/cms/api/awards.php",DT_ABOUT:"data/data/about.json",DT_ABOUT_MOBILE:"data/data/about-mobile.json",DT_CONNECT:"data/data/contact.json",MSG_INIT_DATA:"initData",MSG_RESIZE:"resize",MSG_WINDOW_FOCUS:"window-focus",MSG_WINDOW_BLUR:"window-blur",MSG_LOAD_DATA:"loadData",MSG_ON_DATA_LOADED:"onDataLoaded",MSG_OPEN_SUBNAVI:"openSubnavi",MSG_UPDATE_SUBNAVI:"updateSubnavi",MSG_OPEN_WORK_SUBNAVI:"openWorkSubnavi",MSG_OPEN_SOFT_SUBNAVI:"openSoftSubnavi",MSG_ON_SOFT_SUBNAVI:"onSoftSubnavi",MSG_VIDEO_START:"videoStart",MSG_VIDEO_STOP:"videoEnd",MSG_VIDEO_BUFFER_START:"videoBufferStart",MSG_VIDEO_BUFFER_STOP:"videoBufferStop",SIDENAV:"SIDENAV",SHOW:"show",HIDE:"hide",PREVIEW_MODE:!1},Mouse=new function(){window.navigator.msPointerEnabled?(this.DOWN="MSPointerDown",this.UP="MSPointerUp",this.MOVE="MSPointerMove",this.OVER="MSPointerOver",this.OUT="MSPointerOut",this.CANCEL="MSPointerCancel"):"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?(this.DOWN="touchstart",this.UP="touchend",this.MOVE="touchmove",this.OVER="mouseover",this.OUT="touchleave",this.CANCEL="touchcancel"):(this.DOWN="mousedown",this.UP="mouseup",this.MOVE="mousemove",this.OVER="mouseover",this.OUT="mouseout",this.CANCEL="mousecancel")};
// Original file: Browsers.js
Browsers={init:function(){conditionizr(),Browsers.hasFeature("ie9")||Browsers.setFeature("no-ie9"),Modernizr.addTest("pointerevents",function(){return window.navigator.msPointerEnabled})},hasFeature:function(e){return document.documentElement.className.indexOf(e)!=-1},setFeature:function(e){document.documentElement.className+=" "+e},firefox:function(){return document.documentElement.className.indexOf("firefox")>-1},safari:function(){return document.documentElement.className.indexOf("safari")>-1},chrome:function(){return document.documentElement.className.indexOf("chrome")>-1},ie10:function(){return document.documentElement.className.indexOf(" ie10")>-1},ie9:function(){return document.documentElement.className.indexOf(" ie9")>-1},ie:function(){return Browsers.ie9()||Browsers.ie10()},ipad:function(){return navigator.userAgent.match(/iPad/i)!=null},mobile:function(){return window.location.href.split("?")[1]&&window.location.href.split("?")[1].match("mobile")!=-1?!0:(Modernizr.touch||Modernizr.pointerevents)&&!Browsers.ipad()}};
// Original file: BaseView.js
var BaseView={requestData:function(e,t,n){if(!FJ.Application.model.data[e]){var r=new FJ.Notification(Tool.Actions.MSG_LOAD_DATA);return r.vars={dataUrl:n,dataId:t},FJ.Application.broadcast(r),!0}return!1},animateIn:function(e,t,n,r,i,s){var o=new FJ.ElementWrapper(e);o.animation.set(t,n,r,i,null,s)},showSubnavi:function(e){var t=new FJ.Notification(Tool.Actions.MSG_OPEN_SUBNAVI);t.data=FJ.Application.model.data[e].subnavi,t.data&&FJ.Application.broadcast(t)},scrollToSubnavi:function(e,t,n){var r=document.getElementById(e+"-"+t),i=r?r.offsetTop-Tool.Actions.MENU_HEIGHT*2:0;n.scrollTo(0,i,30)},loadTemplate:function(e,t){console.log("BaseView.loadTemplate()",arguments),FJ.Loader.loadPlainText(e+"?"+Math.random(),function(e){t(new FJ.Template(e),e)})}};
// Original file: ViewState.js
ViewState=function(e,t,n,r,i){var s=this,o=!1;this.lastSlug=null,this.IN_NEW=1,this.IN_OLD=2,this.OUT_NEW=3,this.OUT_OLD=4,this.m=0,this.mByName=function(){switch(s.m){case s.IN_OLD:return"IN_OLD";case s.IN_NEW:return"IN_NEW";case s.OUT_NEW:return"OUT_NEW";case s.OUT_OLD:return"OUT_OLD";default:return"--invald--"}};var u=function(){return(t==-1||window.innerWidth>=t)&&(n==-1||window.innerWidth<n)};this.onNavigation=function(e){var t=new FJ.Slug(e),n=i(t);s.lastSlug=t,o==n?s.m=n?s.IN_OLD:s.OUT_OLD:(s.m=n?s.IN_NEW:s.OUT_NEW,n?r.show():r.hide(),o=n)},this.onResize=function(){if(!o)return;var e=u();return e?r.show():r.hide(),e},this.isVisible=function(){return r.visible}};
// Original file: ImagePreloader.js
ImagePreloader={preload:function(e,t){var n=e.length,r=[],i=function(){n--,n<=0&&t(r)};for(var s=0;s<n;s++){var o=new Image;o.onload=i,o.src=e[s]}}};
// Original file: ScrollThreshold.js
ScrollThreshold=function(e,t,n){var r=null;this.update=function(i){if(r==null){r=i;return}var s=!1;return r>e&&i<e&&(t(),s=!0),r<e&&i>e&&(n(),s=!0),r=i,s}};
// Original file: utils.js
function getVideoUrl(e){var t=document.createElement("video"),n=t.canPlayType("video/webm"),r=navigator.userAgent,i=r.indexOf("Mozilla/5.0")>-1&&r.indexOf("Android ")>-1&&r.indexOf("AppleWebKit")>-1&&!(r.indexOf("Chrome")>-1);return getVideoUrl=function(e){var t=e.split(".mp4")[0];return i&&(n=!1),t="http"+t.split("https")[1],Browsers.ipad()||Browsers.ie9()||window.innerWidth<=Tool.Actions.TABLET_THRESHOLD&&window.innerWidth>Tool.Actions.MOBILE_THRESHOLD?t+="_m":window.innerWidth<Tool.Actions.MOBILE_THRESHOLD&&(t+="_s"),t+=n?".webm":".mp4",t},getVideoUrl(e)}function getVideoType(){return Modernizr.video.webm?"video/webm":"video/mp4"}function fore(e,t){if(e==undefined)return;for(var n in e)t(e[n])}function fori(e,t){if(e==undefined)return;for(var n=0,r=e.length||0;n<r;n++)t(e,n)}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});
// Original file: ScreenSize.js
ScreenSize=function(){var e=new FJ.Notification(Tool.Actions.MSG_RESIZE,FJ.NOTIF_EVENT),t=new FJ.Notification(Tool.Actions.MSG_WINDOW_FOCUS,FJ.NOTIF_EVENT),n=new FJ.Notification(Tool.Actions.MSG_WINDOW_BLUR,FJ.NOTIF_EVENT),r=!0;window.onfocus=function(){r=!0,FJ.Application.broadcast(t)},window.onblur=function(){r=!1,FJ.Application.broadcast(n)};var i=function(){FJ.Application.broadcast(e)};FJ.Capabilities.touch||window.addEventListener("resize",i,!1),FJ.Capabilities.touch&&window.addEventListener("orientationchange",i,!1),i()};
// Original file: KeyboardShortcut.js
KeyboardShortcut=function(){var e=27,t=49,n=new FJ.Notification(FJ.MSG_NAVIGATE);n.type=FJ.NOTIF_NAVIGATION;var r=function(r){switch(r.keyCode){case e:n.slug=Tool.Actions.V_HOME,FJ.Application.broadcast(n);break;case t:n.slug=Tool.Actions.V_WRK,FJ.Application.broadcast(n);break;case t+1:n.slug=Tool.Actions.V_DIR,FJ.Application.broadcast(n);break;case t+2:n.slug=Tool.Actions.V_AWD,FJ.Application.broadcast(n);break;case t+3:n.slug=Tool.Actions.V_ABT,FJ.Application.broadcast(n);break;case t+5:n.slug=Tool.Actions.V_CNT,FJ.Application.broadcast(n);break;default:console.log(r.keyCode)}};window.addEventListener("keydown",r,!1)};
// Original file: DataService.js
DataService=function(){var e=new FJ.Notification(Tool.Actions.MSG_ON_DATA_LOADED);FJ.Application.createMediator().update=function(t){switch(t.message){case Tool.Actions.MSG_INIT_DATA:FJ.Loader.loadJSON(Tool.Actions.DT_INIT,function(e){FJ.Application.model.data.main=e,FJ.Application.init(Tool.Actions.V_HOME)});break;case Tool.Actions.MSG_LOAD_DATA:var n=t.vars.dataUrl;Tool.Actions.PREVIEW_MODE&&(n.indexOf("?")>-1?n+="&preview=true":n+="?preview=true",console.log("Fetching preview data from: "+n)),FJ.Loader.loadJSON(n,function(n){FJ.Application.model.data[t.vars.dataId]=n,e.vars=t.vars,FJ.Application.broadcast(e)})}}};
// Original file: RedirectService.js
RedirectService=function(){FJ.Application.createMediator().update=function(t){switch(t.message){case FJ.MSG_NAVIGATE:var n=new FJ.Slug(t.slug);n.head=="main"&&e(n)}};var e=function(e){console.log("RedirectService.redirect"),console.log(e.parts.join("/"));var t=new FJ.Notification(FJ.MSG_NAVIGATE,FJ.NOTIF_NAVIGATION,Tool.Actions.V_HOME);FJ.Application.broadcast(t)}};
// Original file: Analytics.js
var _gaq=_gaq||[];(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})(),_gaq.push(["_setAccount","UA-8532995-2"]),_gaq.push(["_setDomainName","toolofna.com"]),_gaq.push(["_trackPageview"]),Analytics=function(){FJ.Application.createMediator().update=function(e){switch(e.message){case FJ.MSG_NAVIGATE:setTimeout(function(){_gaq.push(["_trackPageview",e.slug])},1)}}};
// Original file: GlobalBackground.js
GlobalBackground=function(){var e=[],t=function(t){var n=e.indexOf(t);n>=0&&e.splice(n,1)},n=function(t){var n=e.indexOf(t);n==-1&&e.push(t)},r=function(r){var i=document.body;r=r||"#000",t("bodyCoverImage"),n("bodyDottedPatternImage"),i.style.backgroundColor="",i.style.backgroundImage="",i.setAttribute("class",e.join(" "))},i=function(n){var r=document.body;t("bodyCoverImage"),t("bodyDottedPatternImage"),r.style.backgroundColor=n,r.style.backgroundImage="",r.setAttribute("class",e.join(" "))},s=function(){var r=document.body;window.scrollTo(0,0),t("bodyScroll"),n("bodyLock"),r.setAttribute("class",e.join(" "))},o=function(){var r=document.body;t("bodyLock"),n("bodyScroll"),r.setAttribute("class",e.join(" "))};return{setDottedPattern:r,setColor:i,unlockScroll:o,lockScroll:s}}();
